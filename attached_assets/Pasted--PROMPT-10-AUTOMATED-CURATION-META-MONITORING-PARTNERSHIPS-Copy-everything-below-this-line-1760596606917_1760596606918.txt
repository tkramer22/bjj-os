# PROMPT 10: AUTOMATED CURATION + META MONITORING + PARTNERSHIPS üöÄ

Copy everything below this line:

-----

```markdown
# PROMPT 10: AUTOMATED CURATION SYSTEM + META MONITORING + INSTRUCTOR PARTNERSHIPS

Build a complete automated video curation system with meta monitoring and instructor partnership management. This is a large build with 8 sections. Build all sections sequentially without waiting for confirmation between sections. Only pause if a critical error occurs that prevents continuation.

After each section, mark "‚úì Section X complete" in console and continue immediately to next section.

Total estimated build time: 3-4 hours

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 1: DATABASE SCHEMA (Build First - 20 min)

Create the following new tables:

### 1.1 Instructor Credibility Table

```sql
CREATE TABLE IF NOT EXISTS instructor_credibility (
  id SERIAL PRIMARY KEY,
  name TEXT UNIQUE NOT NULL,
  tier INTEGER NOT NULL, -- 1, 2, or 3
  quality_threshold DECIMAL NOT NULL, -- 7.0, 7.5, or 8.0
  
  -- Credentials
  competition_record TEXT,
  belt_rank TEXT DEFAULT 'Black Belt',
  academy_affiliation TEXT,
  
  -- Specialties
  specialties TEXT[], -- ["pressure passing", "leg locks"]
  best_for_belt_level TEXT[], -- ["white", "blue", "purple", "brown", "black"]
  
  -- Teaching style
  teaching_language TEXT DEFAULT 'english', -- "english", "portuguese", "both"
  instruction_style TEXT, -- "systematic", "conceptual", "technical_detail"
  
  -- Analytics
  videos_in_library INTEGER DEFAULT 0,
  avg_helpful_ratio DECIMAL,
  total_recommendations INTEGER DEFAULT 0,
  
  -- Notes
  notes TEXT,
  is_user_instructor BOOLEAN DEFAULT false,
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 1.2 Curation Search Queue Table

```sql
CREATE TABLE IF NOT EXISTS curation_search_queue (
  id SERIAL PRIMARY KEY,
  
  -- Basic info
  search_query TEXT NOT NULL,
  category TEXT, -- "submissions", "passing", "guards", etc.
  priority INTEGER DEFAULT 5, -- 1-10 (10 = highest)
  
  -- Source tracking
  search_type TEXT DEFAULT 'pre_written', -- "pre_written", "ai_generated", "manual"
  generated_reason TEXT, -- "user_gap", "youtube_trend", "coverage_gap", "week_1_plan"
  generated_by TEXT DEFAULT 'system',
  
  -- Targeting
  instructor_focus TEXT, -- "JT Torres", "Danaher", null
  belt_level_target TEXT, -- "white/blue", "purple+", "all"
  technique_focus TEXT,
  
  -- Execution tracking
  executed BOOLEAN DEFAULT false,
  executed_at TIMESTAMP,
  videos_found INTEGER DEFAULT 0,
  videos_added INTEGER DEFAULT 0,
  acceptance_rate DECIMAL,
  
  -- Meta
  week_number INTEGER, -- 1, 2, 3...
  day_number INTEGER, -- 1-7 (for Week 1 structure)
  
  created_at TIMESTAMP DEFAULT NOW()
);
```

### 1.3 Curation Runs Table

```sql
CREATE TABLE IF NOT EXISTS curation_runs (
  id SERIAL PRIMARY KEY,
  run_date TIMESTAMP DEFAULT NOW(),
  run_type TEXT DEFAULT 'scheduled', -- "scheduled", "manual", "test"
  
  search_category TEXT, -- "Day 1: JT Torres + Meta", "Smart Searches", etc.
  
  searches_planned INTEGER,
  searches_completed INTEGER DEFAULT 0,
  searches_failed INTEGER DEFAULT 0,
  
  videos_analyzed INTEGER DEFAULT 0,
  videos_added INTEGER DEFAULT 0,
  videos_rejected INTEGER DEFAULT 0,
  
  acceptance_rate DECIMAL,
  
  status TEXT DEFAULT 'running', -- "running", "completed", "failed", "paused"
  error_message TEXT,
  
  started_at TIMESTAMP DEFAULT NOW(),
  completed_at TIMESTAMP
);
```

### 1.4 Search Queries Log Table

```sql
CREATE TABLE IF NOT EXISTS search_queries_log (
  id SERIAL PRIMARY KEY,
  run_id INTEGER REFERENCES curation_runs(id),
  search_queue_id INTEGER REFERENCES curation_search_queue(id),
  
  query_text TEXT NOT NULL,
  results_found INTEGER DEFAULT 0,
  videos_analyzed INTEGER DEFAULT 0,
  videos_added INTEGER DEFAULT 0,
  videos_rejected INTEGER DEFAULT 0,
  
  acceptance_rate DECIMAL,
  error_message TEXT,
  
  executed_at TIMESTAMP DEFAULT NOW()
);
```

### 1.5 User Technique Requests Table

```sql
CREATE TABLE IF NOT EXISTS user_technique_requests (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  technique_mentioned TEXT NOT NULL,
  request_context TEXT, -- Their actual question
  
  -- Pattern detection
  request_type TEXT, -- "how_to_do", "how_to_defend", "drilling", "general"
  belt_level TEXT,
  gi_preference TEXT,
  
  -- For gap detection
  videos_available_count INTEGER DEFAULT 0,
  was_gap BOOLEAN DEFAULT false, -- Library had <5 videos
  
  requested_at TIMESTAMP DEFAULT NOW()
);
```

### 1.6 Technique Meta Status Table

```sql
CREATE TABLE IF NOT EXISTS technique_meta_status (
  id SERIAL PRIMARY KEY,
  technique_name TEXT UNIQUE NOT NULL,
  technique_category TEXT, -- "submissions", "guards", "passing", etc.
  
  -- Trend signals
  user_request_count INTEGER DEFAULT 0, -- Last 7 days
  user_request_trend TEXT, -- "rising", "hot", "cooling", "stable"
  
  youtube_search_volume INTEGER DEFAULT 0,
  youtube_trend_score DECIMAL DEFAULT 0,
  youtube_week_over_week_change DECIMAL DEFAULT 0,
  
  competition_win_count INTEGER DEFAULT 0, -- If tracked
  competition_trend_score DECIMAL DEFAULT 0,
  
  -- Combined meta score
  overall_meta_score DECIMAL DEFAULT 0, -- Weighted average
  meta_status TEXT DEFAULT 'stable', -- "rising", "hot", "cooling", "stable"
  
  -- Library coverage
  videos_in_library INTEGER DEFAULT 0,
  highest_quality_video_score DECIMAL,
  coverage_status TEXT DEFAULT 'unknown', -- "excellent", "good", "adequate", "poor", "none"
  
  -- Auto-actions
  needs_curation BOOLEAN DEFAULT false,
  curation_priority INTEGER DEFAULT 5, -- 1-10
  smart_searches_generated INTEGER DEFAULT 0,
  
  last_updated TIMESTAMP DEFAULT NOW()
);
```

### 1.7 Featured Instructors Table

```sql
CREATE TABLE IF NOT EXISTS featured_instructors (
  id SERIAL PRIMARY KEY,
  instructor_id INTEGER REFERENCES instructor_credibility(id),
  
  -- Feature settings
  feature_level TEXT NOT NULL, -- 'primary', 'secondary', 'spotlight'
  search_priority_percentage INTEGER NOT NULL, -- 20, 10, 5
  recommendation_boost_percentage INTEGER NOT NULL, -- 50, 30, 15
  
  -- Display settings
  show_badge BOOLEAN DEFAULT true,
  show_name_callout BOOLEAN DEFAULT true,
  custom_callout_text TEXT, -- "Your instructor", "Elite competitor", etc.
  
  -- Duration
  start_date DATE DEFAULT NOW(),
  end_date DATE, -- NULL = permanent
  is_active BOOLEAN DEFAULT true,
  
  -- Partnership details
  partnership_type TEXT, -- 'co_founder', 'promotional', 'standard'
  partnership_agreement TEXT,
  
  -- Their commitment
  social_post_completed BOOLEAN DEFAULT false,
  social_post_date DATE,
  link_in_bio_until DATE,
  
  -- Tracking
  total_recommendations INTEGER DEFAULT 0,
  total_video_views INTEGER DEFAULT 0,
  monthly_recommendation_count INTEGER DEFAULT 0,
  
  -- Notes
  partnership_notes TEXT,
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 1.8 Curation Settings Table

```sql
CREATE TABLE IF NOT EXISTS curation_settings (
  id SERIAL PRIMARY KEY,
  setting_name TEXT UNIQUE NOT NULL,
  setting_value TEXT NOT NULL,
  setting_type TEXT, -- "number", "boolean", "json", "text"
  description TEXT,
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 1.9 Update ai_video_knowledge table

```sql
-- Add new columns to existing table
ALTER TABLE ai_video_knowledge 
ADD COLUMN IF NOT EXISTS tier TEXT DEFAULT 'tier_2',
ADD COLUMN IF NOT EXISTS curation_run_id INTEGER REFERENCES curation_runs(id),
ADD COLUMN IF NOT EXISTS auto_published BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS featured_instructor_id INTEGER REFERENCES featured_instructors(id);
```

‚úì CHECKPOINT 1: Database schema created. Test by running:

```sql
SELECT COUNT(*) FROM instructor_credibility;
SELECT COUNT(*) FROM curation_search_queue;
SELECT COUNT(*) FROM featured_instructors;
```

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 2: POPULATE INSTRUCTOR DATABASE (20 min)

Insert 110+ instructors with their tiers and quality thresholds.

### 2.1 Tier 1 Instructors (7.0 quality threshold)

```sql
INSERT INTO instructor_credibility (name, tier, quality_threshold, competition_record, specialties, notes, is_user_instructor) VALUES

-- IBJJF Legends
('JT Torres', 1, 7.0, '2x Pan Am Champion, IBJJF Black Belt Competitor', ARRAY['guard passing', 'pressure game', 'spider guard', 'competition strategy'], 'User''s instructor - Primary featured', true),
('Roger Gracie', 1, 7.0, 'Greatest gi competitor ever, 10x World Champion', ARRAY['fundamentals', 'mount', 'closed guard', 'basic submissions'], 'Technical perfection', false),
('Marcelo Garcia', 1, 7.0, '5x ADCC Champion, 4x World Champion', ARRAY['guillotine', 'x-guard', 'butterfly guard', 'back attacks'], 'Technical genius', false),
('Bernardo Faria', 1, 7.0, '5x World Champion', ARRAY['pressure passing', 'deep half guard', 'over-under pass'], 'Pressure pass king', false),
('Rafa Mendes', 1, 7.0, '5x World Champion', ARRAY['berimbolo', 'de la riva', 'technical movement'], 'Berimbolo pioneer', false),
('Gui Mendes', 1, 7.0, '4x World Champion', ARRAY['technical precision', 'fundamentals', 'competition prep'], 'Technical perfectionist', false),
('Cobrinha', 1, 7.0, '5x World Champion (Rubens Charles)', ARRAY['spider guard', 'pressure', 'fundamentals'], 'Legendary competitor', false),
('Caio Terra', 1, 7.0, '12x World Champion (all belt levels)', ARRAY['technical details', 'fundamentals', 'small person techniques'], 'Detail-oriented', false),
('Romulo Barral', 1, 7.0, '4x World Champion', ARRAY['spider guard', 'sweeps', 'back takes'], 'Technical excellence', false),
('Leandro Lo', 1, 7.0, '8x World Champion', ARRAY['passing', 'modern concepts', 'de la riva passing'], 'Passing specialist', false),
('Lucas Lepri', 1, 7.0, '9x World Champion', ARRAY['guard', 'pressure', 'competition strategy'], 'Ultra-technical', false),
('Felipe Pena', 1, 7.0, '4x Absolute World Champion', ARRAY['guard', 'submissions', 'pressure'], 'Absolute champion', false),
('Rodolfo Vieira', 1, 7.0, '3x Absolute World Champion', ARRAY['pressure', 'passing', 'mount'], 'Absolute dominance', false),
('Marcus Buchecha', 1, 7.0, '13x World Champion', ARRAY['pressure', 'passing', 'mount', 'submissions'], 'GOAT contender', false),

-- ADCC Champions & No-Gi Legends  
('Gordon Ryan', 1, 7.0, 'Greatest no-gi grappler ever, 3x ADCC Champion', ARRAY['no-gi', 'leg locks', 'passing', 'back attacks'], 'No-gi GOAT', false),
('John Danaher', 1, 7.0, 'Legendary coach, systems builder', ARRAY['leg locks', 'systematic instruction', 'back attacks', 'technical theory'], 'Systematic approach', false),
('Garry Tonon', 1, 7.0, 'ADCC Champion', ARRAY['leg locks', 'no-gi', 'guillotine'], 'Leg lock wizard', false),
('Craig Jones', 1, 7.0, 'ADCC Silver Medalist', ARRAY['leg locks', 'no-gi', 'entertaining instruction'], 'Technical + entertaining', false),
('Lachlan Giles', 1, 7.0, 'ADCC Absolute Bronze Medalist', ARRAY['leg locks', 'systematic instruction', 'half guard'], 'Incredible teacher', false),
('Nicky Ryan', 1, 7.0, 'Prodigy, DDS member', ARRAY['leg locks', 'no-gi', 'systems'], 'Systems approach', false),
('Oliver Taza', 1, 7.0, 'ADCC medalist, rising star', ARRAY['leg locks', 'no-gi', 'clear instruction'], 'Clear instruction', false),
('Ethan Crelinsten', 1, 7.0, 'ADCC medalist', ARRAY['pressure', 'no-gi', 'control'], 'Pressure specialist', false),

-- Legendary Instructors
('Ryan Hall', 1, 7.0, '50/50 guard innovator', ARRAY['inverted guard', '50/50', 'theory', 'concepts'], 'Brilliant theorist', false),
('Keenan Cornelius', 1, 7.0, 'Lapel guard systems creator', ARRAY['lapel guards', 'worm guard', 'gi specialist'], 'Lapel guard innovator', false),
('Jon Thomas', 1, 7.0, 'Clear fundamental instruction', ARRAY['fundamentals', 'clear teaching', 'systematic'], 'Fundamental focus', false),
('Priit Mihkelson', 1, 7.0, 'Structural BJJ creator', ARRAY['structural approach', 'defense', 'fundamentals'], 'Defensive genius', false),
('Henry Akins', 1, 7.0, 'Hidden jiu-jitsu system', ARRAY['fundamentals', 'invisible details', 'Rickson lineage'], 'Hidden techniques', false),
('Rob Biernacki', 1, 7.0, 'Biomechanics expert', ARRAY['technical precision', 'biomechanics', 'teaching'], 'Biomechanics focus', false),
('Kit Dale', 1, 7.0, 'Movement-based approach', ARRAY['movement', 'concepts', 'creativity'], 'Movement approach', false),
('Giancarlo Bodoni', 1, 7.0, 'Technical details specialist', ARRAY['technical details', 'clear teaching'], 'Detail-oriented', false),

-- Modern Competitors
('Mikey Musumeci', 1, 7.0, 'Multiple World Champion, technical innovator', ARRAY['berimbolo', 'technical innovation', 'gi mastery'], 'Technical innovator', false),
('Tye Ruotolo', 1, 7.0, 'Modern no-gi phenom', ARRAY['modern no-gi', 'explosive style', 'creativity'], 'Modern explosiveness', false),
('Kade Ruotolo', 1, 7.0, 'Modern no-gi phenom', ARRAY['modern no-gi', 'technical creativity', 'submissions'], 'Technical creativity', false),
('Nicholas Meregali', 1, 7.0, 'Top game specialist', ARRAY['top game', 'pressure', 'mount'], 'Top control specialist', false),
('Mica Galvao', 1, 7.0, 'Young phenom', ARRAY['all-around game', 'modern techniques', 'competition'], 'Young talent', false),

-- Women's Elite
('Ffion Davies', 1, 7.0, 'Multiple ADCC/IBJJF Champion', ARRAY['no-gi', 'leg locks', 'technical excellence'], 'Women''s elite', false),
('Beatriz Mesquita', 1, 7.0, '8x World Champion', ARRAY['guard', 'sweeps', 'technical skill'], 'Women''s champion', false),
('Mackenzie Dern', 1, 7.0, 'World Champion, ADCC medalist', ARRAY['submissions', 'guard', 'technical skill'], 'Submission specialist', false),
('Bianca Basilio', 1, 7.0, 'Absolute World Champion', ARRAY['pressure', 'mount', 'submissions'], 'Absolute dominance', false),
('Gabrieli Pessanha', 1, 7.0, 'Multiple World Champion', ARRAY['guard', 'sweeps', 'technical precision'], 'Technical excellence', false),

-- Portuguese Legends
('Rickson Gracie', 1, 7.0, 'Legend, undefeated', ARRAY['fundamentals', 'invisible jiu-jitsu', 'pressure'], 'Legendary fundamentals', false),
('Carlos Gracie Jr', 1, 7.0, 'Gracie Barra founder', ARRAY['fundamentals', 'teaching methodology'], 'GB founder', false),
('Royler Gracie', 1, 7.0, 'Multiple World Champion', ARRAY['fundamentals', 'technical precision'], 'Technical legend', false),
('Saulo Ribeiro', 1, 7.0, 'Jiu-Jitsu University author, 6x World Champion', ARRAY['fundamentals', 'systematic teaching'], 'Systematic approach', false),
('Xande Ribeiro', 1, 7.0, '8x World Champion', ARRAY['fundamentals', 'technical precision', 'competition'], 'Technical mastery', false),
('Andre Galvao', 1, 7.0, 'ADCC legend, multiple champion', ARRAY['no-gi', 'wrestling', 'competition'], 'Competitor & teacher', false),
('Leonardo Vieira', 1, 7.0, 'Checkmat founder', ARRAY['fundamentals', 'competition', 'teaching'], 'Checkmat system', false),
('Lucas Leite', 1, 7.0, 'Half guard specialist', ARRAY['half guard', 'coyote half', 'sweeps'], 'Half guard master', false),
('Murilo Santana', 1, 7.0, 'Technical innovator', ARRAY['innovation', 'technical details'], 'Innovative approach', false),
('Langhi Brothers', 1, 7.0, 'Lapel guard specialists', ARRAY['lapel guards', 'technical precision'], 'Lapel specialists', false),

-- Judo Crossover
('Travis Stevens', 1, 7.0, 'Olympics silver, BJJ black belt', ARRAY['judo', 'takedowns', 'throws'], 'Judo for BJJ', false),
('Jimmy Pedro', 1, 7.0, 'Olympics bronze', ARRAY['judo', 'takedowns', 'gripping'], 'Judo fundamentals', false),
('Neil Adams', 1, 7.0, 'Olympics gold', ARRAY['judo', 'throws', 'gripping'], 'Judo mastery', false),
('Shintaro Higashi', 1, 7.0, 'Clear judo instruction', ARRAY['judo', 'takedowns', 'clear teaching'], 'Clear judo teaching', false)

ON CONFLICT (name) DO NOTHING;
```

### 2.2 Tier 2 Instructors (7.5 quality threshold)

```sql
INSERT INTO instructor_credibility (name, tier, quality_threshold, specialties, notes) VALUES

-- YouTube Instructors
('Chewy', 2, 7.5, ARRAY['fundamentals', 'approachable instruction'], 'Chewjitsu - 500K+ subscribers'),
('Stephan Kesting', 2, 7.5, ARRAY['fundamentals', 'clear teaching'], 'Grapplearts - veteran instructor'),
('Matt Arroyo', 2, 7.5, ARRAY['technical detail', 'budo videos'], 'Technical instructor'),
('Knight Jiu Jitsu', 2, 7.5, ARRAY['fundamentals', 'clear explanations'], 'Fundamentals-focused'),
('Invisible Jiu Jitsu', 2, 7.5, ARRAY['body mechanics', 'unique approach'], 'Unique perspective'),
('Submissions 101', 2, 7.5, ARRAY['tutorials', 'good production'], 'Clear tutorials'),
('ZombieProofBJJ', 2, 7.5, ARRAY['self-defense', 'practical'], 'Self-defense focused'),

-- Competitor-Instructors
('Adam Wardzinski', 2, 7.5, ARRAY['butterfly guard', 'specialist'], 'Butterfly specialist'),
('Neil Melanson', 2, 7.5, ARRAY['catch wrestling', 'submissions'], 'Catch wrestling for BJJ'),
('Tom DeBlass', 2, 7.5, ARRAY['pressure', 'mental game'], 'Pressure + mindset'),
('Bernardo Pitel', 2, 7.5, ARRAY['clear instruction', 'fundamentals'], 'Clear teaching'),
('Josh Hinger', 2, 7.5, ARRAY['systematic', 'competition'], 'Systematic approach'),
('Edwin Najmi', 2, 7.5, ARRAY['competition', 'mindset'], 'Competition mindset'),
('Tanquinho', 2, 7.5, ARRAY['fundamentals', 'caio terra academy'], 'Fundamentals focused'),

-- Academy Channels
('Atos Jiu Jitsu', 2, 7.5, ARRAY['mendes bros content', 'high level'], 'Mendes Bros academy'),
('Renzo Gracie Academy', 2, 7.5, ARRAY['fundamentals', 'renzo lineage'], 'Fundamental techniques'),
('Tristar Gym', 2, 7.5, ARRAY['firas zahabi', 'mma approach'], 'MMA-focused BJJ'),
('Alliance Jiu Jitsu', 2, 7.5, ARRAY['competition', 'high level'], 'Competition-tested'),
('Gracie Barra', 2, 7.5, ARRAY['structured curriculum'], 'Structured content'),

-- Specialized Instructors
('Lenny Lovato Jr', 2, 7.5, ARRAY['mount specialist'], 'Mount mastery'),
('Tarik Hopstock', 2, 7.5, ARRAY['leg locks', 'details'], 'Leg lock details'),
('Miha Perhoc', 2, 7.5, ARRAY['systematic'], 'Systematic instruction'),
('Ze Radiola', 2, 7.5, ARRAY['spider guard', 'technical'], 'Spider guard specialist'),
('Robson Moura', 2, 7.5, ARRAY['fundamentals', 'teaching'], 'Fundamental teaching'),
('Braulio Estima', 2, 7.5, ARRAY['technical', 'competition'], 'Technical excellence'),
('Victor Estima', 2, 7.5, ARRAY['technical', 'details'], 'Detail-oriented'),

-- Scientific/Academic
('BJJ Mental Models', 2, 7.5, ARRAY['conceptual frameworks'], 'Conceptual approach'),
('Chris Paines', 2, 7.5, ARRAY['systems thinking'], 'Systems approach'),
('Steve Maxwell', 2, 7.5, ARRAY['conditioning', 'fundamentals'], 'Conditioning for BJJ')

ON CONFLICT (name) DO NOTHING;
```

‚úì CHECKPOINT 2: Instructors populated. Test by running:

```sql
SELECT name, tier, quality_threshold, is_user_instructor FROM instructor_credibility WHERE name = 'JT Torres';
SELECT COUNT(*) as tier1_count FROM instructor_credibility WHERE tier = 1;
SELECT COUNT(*) as tier2_count FROM instructor_credibility WHERE tier = 2;
```

Should show JT Torres marked as user‚Äôs instructor, ~70 Tier 1, ~30 Tier 2.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 3: POPULATE WEEK 1 SEARCH QUERIES (15 min)

Insert 175 pre-written search queries for Week 1 (Day 1-7, 25 searches per day).

### 3.1 Day 1: JT Torres Showcase + Current Meta (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres Focus (8 searches)
('JT Torres guard passing fundamentals', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres pressure passing concepts', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres spider guard control', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres competition strategy', 'competition', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres mount control details', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'all', 1, 1),
('JT Torres side control transitions', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres back attack system', 'submissions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 1),
('JT Torres closed guard attacks', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'all', 1, 1),

-- Current Meta (17 searches)
('bodylock passing system Gordon Ryan', 'passing', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 1),
('defending bodylock pass Lachlan Giles', 'passing', 9, 'pre_written', 'week_1_plan', 'Lachlan Giles', 'purple+', 1, 1),
('bodylock passing fundamentals', 'passing', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('saddle position entries', 'leg locks', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('inside sankaku leg locks', 'leg locks', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('false reap position details', 'leg locks', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('50/50 guard modern concepts', 'guards', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('k-guard system fundamentals', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('reverse de la riva passing', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('modern guard retention concepts', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('headquarters position passing', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('leg drag passing details', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('single leg X guard sweeps', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('x-guard to single leg X transition', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('deep half guard modern system', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('quarter guard bottom concepts', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1),
('octopus guard fundamentals', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 1)

ON CONFLICT DO NOTHING;
```

### 3.2 Day 2: Advanced Submissions (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (4 searches)
('JT Torres submission chains', 'submissions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 2),
('JT Torres armbar details', 'submissions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 2),
('JT Torres triangle setup', 'submissions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 2),
('JT Torres choke variations', 'submissions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 2),

-- Elite Submissions (21 searches)
('Danaher triangle system', 'submissions', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 2),
('Danaher rear naked choke details', 'submissions', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 2),
('Gordon Ryan armbar from mount', 'submissions', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 2),
('Gordon Ryan triangle variations', 'submissions', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 2),
('Lachlan Giles submission chains', 'submissions', 9, 'pre_written', 'week_1_plan', 'Lachlan Giles', 'purple+', 1, 2),
('Marcelo Garcia guillotine system', 'submissions', 9, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 2),
('Marcelo Garcia arm-in guillotine', 'submissions', 9, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 2),
('Roger Gracie cross collar choke', 'submissions', 9, 'pre_written', 'week_1_plan', 'Roger Gracie', 'purple+', 1, 2),
('triangle choke common mistakes', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('armbar from guard details', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('kimura from closed guard', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('omoplata finish details', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('bow and arrow choke details', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('darce choke fundamentals', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('anaconda choke setup', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('ezekiel choke from mount', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('baseball choke variations', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('loop choke from standing', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('wrist lock fundamentals', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('brabo choke details', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2),
('mounted triangle details', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 2)

ON CONFLICT DO NOTHING;
```

### 3.3 Day 3: Guard Systems Advanced (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (4 searches)
('JT Torres spider guard system', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 3),
('JT Torres de la riva guard', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 3),
('JT Torres guard retention', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 3),
('JT Torres half guard concepts', 'guards', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 3),

-- Modern Guards (21 searches)
('Rafa Mendes berimbolo system', 'guards', 9, 'pre_written', 'week_1_plan', 'Rafa Mendes', 'purple+', 1, 3),
('Rafa Mendes de la riva guard', 'guards', 9, 'pre_written', 'week_1_plan', 'Rafa Mendes', 'purple+', 1, 3),
('Gui Mendes spider guard details', 'guards', 9, 'pre_written', 'week_1_plan', 'Gui Mendes', 'purple+', 1, 3),
('Keenan Cornelius worm guard', 'guards', 9, 'pre_written', 'week_1_plan', 'Keenan Cornelius', 'purple+', 1, 3),
('Keenan Cornelius lapel guard system', 'guards', 9, 'pre_written', 'week_1_plan', 'Keenan Cornelius', 'purple+', 1, 3),
('Mikey Musumeci berimbolo details', 'guards', 9, 'pre_written', 'week_1_plan', 'Mikey Musumeci', 'purple+', 1, 3),
('Lachlan Giles half guard retention', 'guards', 9, 'pre_written', 'week_1_plan', 'Lachlan Giles', 'purple+', 1, 3),
('Lucas Leite coyote half guard', 'guards', 9, 'pre_written', 'week_1_plan', 'Lucas Leite', 'purple+', 1, 3),
('50/50 guard sweeps', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('reverse de la riva guard fundamentals', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('x-guard Marcelo Garcia', 'guards', 8, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 3),
('butterfly guard Marcelo Garcia', 'guards', 8, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 3),
('single leg X guard system', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('deep half guard sweeps', 'guards', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('spider guard fundamentals', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('lasso guard attacks', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('collar sleeve guard system', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('shin to shin guard', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('quarter guard recovery', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('z-guard concepts', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3),
('lockdown half guard', 'guards', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 3)

ON CONFLICT DO NOTHING;
```

### 3.4 Day 4: Passing Systems Elite (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (4 searches)
('JT Torres pressure passing system', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 4),
('JT Torres toreando pass', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 4),
('JT Torres knee slice details', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 4),
('JT Torres stack passing', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 4),

-- Elite Passing (21 searches)
('Bernardo Faria pressure passing', 'passing', 9, 'pre_written', 'week_1_plan', 'Bernardo Faria', 'purple+', 1, 4),
('Bernardo Faria over under pass', 'passing', 9, 'pre_written', 'week_1_plan', 'Bernardo Faria', 'purple+', 1, 4),
('Leandro Lo passing system', 'passing', 9, 'pre_written', 'week_1_plan', 'Leandro Lo', 'purple+', 1, 4),
('Leandro Lo de la riva pass', 'passing', 9, 'pre_written', 'week_1_plan', 'Leandro Lo', 'purple+', 1, 4),
('Lucas Lepri guard passing', 'passing', 9, 'pre_written', 'week_1_plan', 'Lucas Lepri', 'purple+', 1, 4),
('Buchecha pressure passing', 'passing', 9, 'pre_written', 'week_1_plan', 'Marcus Buchecha', 'purple+', 1, 4),
('Rodolfo Vieira passing concepts', 'passing', 9, 'pre_written', 'week_1_plan', 'Rodolfo Vieira', 'purple+', 1, 4),
('Roger Gracie passing fundamentals', 'passing', 9, 'pre_written', 'week_1_plan', 'Roger Gracie', 'purple+', 1, 4),
('toreando pass fundamentals', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('knee slice pass details', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('x-pass guard passing', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('leg drag passing system', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('long step passing', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('stack passing fundamentals', 'passing', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('smash passing concepts', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('headquarters passing', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('backstep passing de la riva', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('cartwheel pass spider guard', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('leg weave passing', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('over under pass variations', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4),
('double under pass details', 'passing', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 4)

ON CONFLICT DO NOTHING;
```

### 3.5 Day 5: No-Gi & Leg Locks (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (3 searches)
('JT Torres no-gi concepts', 'no-gi', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 5),
('JT Torres wrestling for BJJ', 'takedowns', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 5),
('JT Torres no-gi passing', 'passing', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 5),

-- No-Gi & Leg Locks (22 searches)
('Gordon Ryan no-gi passing system', 'passing', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 5),
('Gordon Ryan leg lock entries', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 5),
('Gordon Ryan saddle position', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 5),
('Craig Jones leg lock system', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Craig Jones', 'purple+', 1, 5),
('Craig Jones z-lock details', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Craig Jones', 'purple+', 1, 5),
('Lachlan Giles heel hook defense', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Lachlan Giles', 'purple+', 1, 5),
('Lachlan Giles leg lock system', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Lachlan Giles', 'purple+', 1, 5),
('Garry Tonon heel hook fundamentals', 'leg locks', 9, 'pre_written', 'week_1_plan', 'Garry Tonon', 'purple+', 1, 5),
('Danaher leg lock system', 'leg locks', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 5),
('Danaher ashi garami fundamentals', 'leg locks', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 5),
('saddle position entries fundamentals', 'leg locks', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('straight ankle lock details', 'leg locks', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('toe hold fundamentals', 'leg locks', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('kneebar from top', 'leg locks', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('50/50 leg lock attacks', 'leg locks', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('front headlock system', 'no-gi', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('no-gi guard retention', 'no-gi', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('wrestling for BJJ fundamentals', 'takedowns', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('single leg takedown BJJ', 'takedowns', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('double leg takedown details', 'takedowns', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('ankle pick fundamentals', 'takedowns', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5),
('arm drag to back take', 'takedowns', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 5)

ON CONFLICT DO NOTHING;
```

### 3.6 Day 6: Back Attacks & Top Control (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (4 searches)
('JT Torres back control maintenance', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 6),
('JT Torres mount attacks', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 6),
('JT Torres back take opportunities', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 6),
('JT Torres top control concepts', 'positions', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 6),

-- Back & Top Control (21 searches)
('Marcelo Garcia back control', 'positions', 9, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 6),
('Marcelo Garcia back take system', 'positions', 9, 'pre_written', 'week_1_plan', 'Marcelo Garcia', 'purple+', 1, 6),
('Danaher back attack system', 'positions', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 6),
('Danaher rear naked choke details', 'submissions', 9, 'pre_written', 'week_1_plan', 'John Danaher', 'purple+', 1, 6),
('Roger Gracie mount mastery', 'positions', 9, 'pre_written', 'week_1_plan', 'Roger Gracie', 'purple+', 1, 6),
('Roger Gracie mount maintenance', 'positions', 9, 'pre_written', 'week_1_plan', 'Roger Gracie', 'purple+', 1, 6),
('Gordon Ryan back control no-gi', 'positions', 9, 'pre_written', 'week_1_plan', 'Gordon Ryan', 'purple+', 1, 6),
('back control fundamentals', 'positions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('back take from turtle', 'positions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('rear naked choke details', 'submissions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('mount escapes prevention', 'positions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('mount attacks systematic', 'positions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('technical mount details', 'positions', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('s-mount position attacks', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('high mount control', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('back control hand fighting', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('seat belt grip details', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('body triangle back control', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('hooks back control maintenance', 'positions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('short choke variations', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6),
('bow and arrow from back', 'submissions', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 6)

ON CONFLICT DO NOTHING;
```

### 3.7 Day 7: Competition + Portuguese (25 searches)

```sql
INSERT INTO curation_search_queue (search_query, category, priority, search_type, generated_reason, instructor_focus, belt_level_target, week_number, day_number) VALUES

-- JT Torres (3 searches)
('JT Torres competition preparation', 'competition', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 7),
('JT Torres tournament strategy', 'competition', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 7),
('JT Torres mental game', 'competition', 10, 'pre_written', 'week_1_plan', 'JT Torres', 'purple+', 1, 7),

-- Competition Strategy (12 searches)
('competition gameplan strategy', 'competition', 9, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('IBJJF rules strategy', 'competition', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('tournament preparation checklist', 'competition', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('competition mindset mental game', 'competition', 8, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('first tournament preparation', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('weight cutting for BJJ', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('competition warm up routine', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('dealing with competition nerves', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('post competition analysis', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('points vs submission strategy', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('stalling prevention competition', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),
('advantages IBJJF rules', 'competition', 7, 'pre_written', 'week_1_plan', NULL, 'purple+', 1, 7),

-- Portuguese Content (10 searches)
('Buchecha pressure game', 'positions', 8, 'pre_written', 'week_1_plan', 'Marcus Buchecha', 'purple+', 1, 7),
('Langhi brothers lapel guard', 'guards', 8, 'pre_written', 'week_1_plan', 'Langhi Brothers', 'purple+', 1, 7),
('Andre Galvao competition strategy', 'competition', 8, 'pre_written', 'week_1_plan', 'Andre Galvao', 'purple+', 1, 7),
('Rafa Mendes movimento', 'guards', 8, 'pre_written', 'week_1_plan', 'Rafa Mendes', 'purple+', 1, 7),
('Lucas Leite meia guarda', 'guards', 8, 'pre_written', 'week_1_plan', 'Lucas Leite', 'purple+', 1, 7),
('Rodolfo Vieira finaliza√ß√£o', 'submissions', 7, 'pre_written', 'week_1_plan', 'Rodolfo Vieira', 'purple+', 1, 7),
('Murilo Santana t√©cnicas', 'fundamentals', 7, 'pre_written', 'week_1_plan', 'Murilo Santana', 'purple+', 1, 7),
('Saulo Ribeiro fundamentos', 'fundamentals', 7, 'pre_written', 'week_1_plan', 'Saulo Ribeiro', 'purple+', 1, 7),
('Xande Ribeiro jiu jitsu', 'fundamentals', 7, 'pre_written', 'week_1_plan', 'Xande Ribeiro', 'purple+', 1, 7),
('Leonardo Vieira checkmat', 'fundamentals', 7, 'pre_written', 'week_1_plan', 'Leonardo Vieira', 'purple+', 1, 7)

ON CONFLICT DO NOTHING;
```

‚úì CHECKPOINT 3: Search queries populated. Test by running:

```sql
SELECT COUNT(*) as total_searches FROM curation_search_queue WHERE week_number = 1;
SELECT day_number, COUNT(*) as searches_per_day FROM curation_search_queue WHERE week_number = 1 GROUP BY day_number ORDER BY day_number;
SELECT COUNT(*) as jt_torres_searches FROM curation_search_queue WHERE instructor_focus = 'JT Torres' AND week_number = 1;
```

Should show 175 total searches, 25 per day, ~30 JT Torres searches.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 4: FEATURED INSTRUCTORS SETUP (10 min)

Set up default featured instructors: JT Torres (Primary), Gordon Ryan + Lachlan Giles (Secondary for testing).

```sql
-- Get instructor IDs first
WITH instructor_ids AS (
  SELECT id, name FROM instructor_credibility 
  WHERE name IN ('JT Torres', 'Gordon Ryan', 'Lachlan Giles')
)

INSERT INTO featured_instructors (
  instructor_id,
  feature_level,
  search_priority_percentage,
  recommendation_boost_percentage,
  show_badge,
  show_name_callout,
  custom_callout_text,
  start_date,
  end_date,
  is_active,
  partnership_type,
  partnership_agreement,
  partnership_notes
)
SELECT 
  id,
  CASE 
    WHEN name = 'JT Torres' THEN 'primary'
    ELSE 'secondary'
  END,
  CASE 
    WHEN name = 'JT Torres' THEN 20
    ELSE 10
  END,
  CASE 
    WHEN name = 'JT Torres' THEN 50
    ELSE 30
  END,
  true,
  true,
  CASE 
    WHEN name = 'JT Torres' THEN 'Your instructor'
    WHEN name = 'Gordon Ryan' THEN 'Elite no-gi competitor'
    WHEN name = 'Lachlan Giles' THEN 'Systematic instruction specialist'
  END,
  CURRENT_DATE,
  CASE 
    WHEN name = 'JT Torres' THEN NULL  -- Permanent
    ELSE CURRENT_DATE + INTERVAL '30 days'  -- 30-day test
  END,
  true,
  CASE 
    WHEN name = 'JT Torres' THEN 'co_founder'
    ELSE 'promotional'
  END,
  CASE 
    WHEN name = 'JT Torres' THEN 'Permanent featured status - user''s instructor'
    ELSE '30-day promotional test - platform exposure for social mention'
  END,
  CASE 
    WHEN name = 'JT Torres' THEN 'Primary partner - built into app foundation'
    WHEN name = 'Gordon Ryan' THEN 'Testing featured system - best no-gi content'
    WHEN name = 'Lachlan Giles' THEN 'Testing featured system - systematic teaching'
  END
FROM instructor_ids
ON CONFLICT DO NOTHING;
```

‚úì CHECKPOINT 4: Featured instructors set up. Test by running:

```sql
SELECT 
  ic.name,
  fi.feature_level,
  fi.recommendation_boost_percentage,
  fi.is_active,
  fi.end_date
FROM featured_instructors fi
JOIN instructor_credibility ic ON fi.instructor_id = ic.id;
```

Should show JT Torres (primary, 50% boost, permanent), Gordon + Lachlan (secondary, 30% boost, 30 days).

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 5: CURATION SETTINGS DEFAULTS (10 min)

Populate default curation settings.

```sql
INSERT INTO curation_settings (setting_name, setting_value, setting_type, description) VALUES

-- Curation speed settings
('curation_mode', 'ultra_aggressive', 'text', 'Current curation mode: week_1, ultra_aggressive, aggressive, moderate, light, custom'),
('runs_per_day', '4', 'number', 'Number‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã
```

of scheduled curation runs per day‚Äô),
(‚Äòsearches_per_run‚Äô, ‚Äò25‚Äô, ‚Äònumber‚Äô, ‚ÄòNumber of searches to execute per run‚Äô),
(‚Äòdaily_search_total‚Äô, ‚Äò100‚Äô, ‚Äònumber‚Äô, ‚ÄòTotal searches per day (calculated)‚Äô),

‚Äì Schedule times
(‚Äòrun_schedule‚Äô, ‚Äò[‚Äú06:00‚Äù, ‚Äú12:00‚Äù, ‚Äú18:00‚Äù, ‚Äú00:00‚Äù]‚Äô, ‚Äòjson‚Äô, ‚ÄòTimes for scheduled curation runs (24-hour format)‚Äô),

‚Äì Search mix percentages
(‚Äòsmart_search_percentage‚Äô, ‚Äò40‚Äô, ‚Äònumber‚Äô, ‚ÄòPercentage of searches for user gaps and meta trends‚Äô),
(‚Äòcoverage_gap_percentage‚Äô, ‚Äò30‚Äô, ‚Äònumber‚Äô, ‚ÄòPercentage of searches for library coverage gaps‚Äô),
(‚Äòinstructor_rotation_percentage‚Äô, ‚Äò30‚Äô, ‚Äònumber‚Äô, ‚ÄòPercentage of searches for instructor variety‚Äô),

‚Äì Quality thresholds
(‚Äòuser_visible_quality_threshold‚Äô, ‚Äò7.5‚Äô, ‚Äònumber‚Äô, ‚ÄòMinimum quality score for videos shown to users‚Äô),
(‚Äòauto_publish_threshold‚Äô, ‚Äò7.5‚Äô, ‚Äònumber‚Äô, ‚ÄòMinimum quality score for automatic publishing‚Äô),

‚Äì Error handling
(‚Äòmax_errors_before_pause‚Äô, ‚Äò5‚Äô, ‚Äònumber‚Äô, ‚ÄòMaximum errors in single run before pausing‚Äô),
(‚Äòskip_failed_searches‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòContinue to next search if one fails‚Äô),

‚Äì Meta monitoring
(‚Äòyoutube_meta_enabled‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòEnable YouTube trend monitoring‚Äô),
(‚Äòuser_request_gap_threshold‚Äô, ‚Äò3‚Äô, ‚Äònumber‚Äô, ‚ÄòNumber of user requests before flagging as gap‚Äô),
(‚Äòmeta_analysis_schedule‚Äô, ‚Äò03:00‚Äô, ‚Äòtext‚Äô, ‚ÄòTime to run daily meta analysis (24-hour format)‚Äô),

‚Äì API management
(‚Äòyoutube_api_quota_warning‚Äô, ‚Äò9000‚Äô, ‚Äònumber‚Äô, ‚ÄòYouTube API units before warning (out of 10,000)‚Äô),
(‚Äòpause_on_quota_exceeded‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòAutomatically pause curation if quota exceeded‚Äô),

‚Äì Week 1 specific
(‚Äòweek_1_active‚Äô, ‚Äòfalse‚Äô, ‚Äòboolean‚Äô, ‚ÄòWhether Week 1 aggressive curation is active‚Äô),
(‚Äòweek_1_start_date‚Äô, ‚Äò‚Äô, ‚Äòtext‚Äô, ‚ÄòISO date when Week 1 curation started‚Äô),
(‚Äòweek_1_current_day‚Äô, ‚Äò0‚Äô, ‚Äònumber‚Äô, ‚ÄòCurrent day in Week 1 (0-7)‚Äô),

‚Äì Post-Week 1 settings
(‚Äòpost_week_1_runs_per_day‚Äô, ‚Äò3‚Äô, ‚Äònumber‚Äô, ‚ÄòRuns per day after Week 1 completes‚Äô),
(‚Äòpost_week_1_searches_per_run‚Äô, ‚Äò30‚Äô, ‚Äònumber‚Äô, ‚ÄòSearches per run after Week 1‚Äô),

‚Äì System status
(‚Äòcuration_active‚Äô, ‚Äòfalse‚Äô, ‚Äòboolean‚Äô, ‚ÄòMaster switch for all curation‚Äô),
(‚Äòlast_run_completed‚Äô, ‚Äò‚Äô, ‚Äòtext‚Äô, ‚ÄòISO timestamp of last completed run‚Äô),
(‚Äòtotal_runs_completed‚Äô, ‚Äò0‚Äô, ‚Äònumber‚Äô, ‚ÄòTotal number of curation runs completed‚Äô),

‚Äì Notifications
(‚Äòalert_on_api_quota‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòShow alert when API quota exceeded‚Äô),
(‚Äòalert_on_low_acceptance‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòShow alert when acceptance rate drops below 50%‚Äô),
(‚Äòalert_on_errors‚Äô, ‚Äòtrue‚Äô, ‚Äòboolean‚Äô, ‚ÄòShow alert on curation errors‚Äô)

ON CONFLICT (setting_name) DO UPDATE SET
setting_value = EXCLUDED.setting_value,
updated_at = NOW();

```
‚úì CHECKPOINT 5: Curation settings configured. Test by running:
```sql
SELECT setting_name, setting_value, setting_type FROM curation_settings ORDER BY setting_name;
```

Should show all default settings.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 6: CURATION ENGINE & META MONITORING (60 min)

Build the core curation logic, smart search generation, and YouTube meta monitoring.

Create new file: `server/curation-engine.ts`

```typescript
import { anthropic } from './anthropic';
import { youtube } from '@googleapis/youtube';
import postgres from 'postgres';

const sql = postgres(process.env.DATABASE_URL!);

const youtubeClient = youtube({
  version: 'v3',
  auth: process.env.YOUTUBE_API_KEY
});

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// MAIN CURATION FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

export async function executeCurationRun(runType: 'scheduled' | 'manual' | 'test' = 'scheduled') {
  console.log(`üöÄ Starting ${runType} curation run...`);
  
  const runId = await createCurationRun(runType);
  
  try {
    // Get next searches from queue
    const searches = await getNextSearches();
    
    if (searches.length === 0) {
      await updateCurationRun(runId, { status: 'completed', error_message: 'No searches in queue' });
      console.log('‚ö†Ô∏è No searches found in queue');
      return { success: false, message: 'No searches in queue' };
    }
    
    console.log(`üìã Executing ${searches.length} searches...`);
    
    let videosAnalyzed = 0;
    let videosAdded = 0;
    let videosRejected = 0;
    let searchesCompleted = 0;
    let searchesFailed = 0;
    
    for (const search of searches) {
      try {
        console.log(`üîç Search ${searchesCompleted + 1}/${searches.length}: "${search.search_query}"`);
        
        const result = await executeSearch(search.search_query, search.id, runId);
        
        videosAnalyzed += result.analyzed;
        videosAdded += result.added;
        videosRejected += result.rejected;
        searchesCompleted++;
        
        // Mark search as executed
        await sql`
          UPDATE curation_search_queue 
          SET executed = true, 
              executed_at = NOW(),
              videos_found = ${result.found},
              videos_added = ${result.added},
              acceptance_rate = ${result.acceptance_rate}
          WHERE id = ${search.id}
        `;
        
      } catch (error: any) {
        console.error(`‚ùå Search failed: ${search.search_query}`, error.message);
        searchesFailed++;
        
        // Check error threshold
        const settings = await getCurationSettings();
        if (searchesFailed >= parseInt(settings.max_errors_before_pause)) {
          console.error(`üõë Too many errors (${searchesFailed}), pausing curation`);
          await updateCurationRun(runId, { 
            status: 'failed', 
            error_message: `${searchesFailed} searches failed - threshold exceeded` 
          });
          await pauseCuration();
          break;
        }
        
        // Continue to next search (skip-and-continue behavior)
        continue;
      }
    }
    
    const acceptanceRate = videosAnalyzed > 0 ? (videosAdded / videosAnalyzed) * 100 : 0;
    
    await updateCurationRun(runId, {
      searches_completed: searchesCompleted,
      searches_failed: searchesFailed,
      videos_analyzed: videosAnalyzed,
      videos_added: videosAdded,
      videos_rejected: videosRejected,
      acceptance_rate: acceptanceRate,
      status: 'completed',
      completed_at: new Date()
    });
    
    console.log(`‚úÖ Curation run complete: ${videosAdded} videos added (${acceptanceRate.toFixed(1)}% acceptance)`);
    
    // Check for low acceptance rate alert
    if (acceptanceRate < 50 && videosAnalyzed > 20) {
      console.warn(`‚ö†Ô∏è Low acceptance rate: ${acceptanceRate.toFixed(1)}%`);
      await createAlert('low_acceptance_rate', `Acceptance rate dropped to ${acceptanceRate.toFixed(1)}%`);
    }
    
    return {
      success: true,
      videosAdded,
      videosAnalyzed,
      acceptanceRate: acceptanceRate.toFixed(1)
    };
    
  } catch (error: any) {
    console.error('‚ùå Curation run failed:', error);
    await updateCurationRun(runId, { 
      status: 'failed', 
      error_message: error.message 
    });
    throw error;
  }
}

async function executeSearch(query: string, searchQueueId: number, runId: number) {
  // Search YouTube
  const searchResults = await youtubeClient.search.list({
    part: ['snippet'],
    q: query,
    type: ['video'],
    maxResults: 10,
    relevanceLanguage: 'en',
    videoDefinition: 'high'
  });
  
  const videoIds = searchResults.data.items?.map(item => item.id?.videoId).filter(Boolean) || [];
  
  if (videoIds.length === 0) {
    return { found: 0, analyzed: 0, added: 0, rejected: 0, acceptance_rate: 0 };
  }
  
  // Get video details
  const videoDetails = await youtubeClient.videos.list({
    part: ['snippet', 'contentDetails', 'statistics'],
    id: videoIds as string[]
  });
  
  const videos = videoDetails.data.items || [];
  
  let analyzed = 0;
  let added = 0;
  let rejected = 0;
  
  for (const video of videos) {
    // Pre-filter checks
    if (!shouldAnalyzeVideo(video)) {
      rejected++;
      continue;
    }
    
    analyzed++;
    
    try {
      // Get transcript
      const transcript = await getVideoTranscript(video.id!);
      
      if (!transcript || transcript.length < 500) {
        console.log(`‚è≠Ô∏è Skipping ${video.snippet?.title} - no transcript or too short`);
        rejected++;
        continue;
      }
      
      // Analyze with Claude
      const analysis = await analyzeVideoWithClaude(video, transcript);
      
      if (!analysis) {
        rejected++;
        continue;
      }
      
      // Check quality threshold
      const instructor = await getInstructorByName(analysis.instructor);
      const qualityThreshold = instructor?.quality_threshold || 8.0;
      
      if (analysis.quality_score >= qualityThreshold) {
        // Add to library
        await addVideoToLibrary(video, analysis, runId, searchQueueId);
        added++;
        console.log(`‚úÖ Added: ${video.snippet?.title} (${analysis.quality_score}/10)`);
      } else {
        rejected++;
        console.log(`‚ùå Rejected: ${video.snippet?.title} (${analysis.quality_score}/10 < ${qualityThreshold})`);
      }
      
    } catch (error: any) {
      console.error(`Error analyzing video ${video.snippet?.title}:`, error.message);
      rejected++;
    }
  }
  
  const acceptanceRate = analyzed > 0 ? (added / analyzed) * 100 : 0;
  
  // Log search execution
  await sql`
    INSERT INTO search_queries_log (
      run_id, search_queue_id, query_text, results_found,
      videos_analyzed, videos_added, videos_rejected, acceptance_rate
    ) VALUES (
      ${runId}, ${searchQueueId}, ${query}, ${videos.length},
      ${analyzed}, ${added}, ${rejected}, ${acceptanceRate}
    )
  `;
  
  return { 
    found: videos.length, 
    analyzed, 
    added, 
    rejected, 
    acceptance_rate: acceptanceRate 
  };
}

function shouldAnalyzeVideo(video: any): boolean {
  const duration = video.contentDetails?.duration;
  const publishedAt = new Date(video.snippet?.publishedAt);
  const fiveYearsAgo = new Date();
  fiveYearsAgo.setFullYear(fiveYearsAgo.getFullYear() - 5);
  
  // Must be 5+ minutes long
  if (duration) {
    const match = duration.match(/PT(\d+)M/);
    const minutes = match ? parseInt(match[1]) : 0;
    if (minutes < 5) return false;
  }
  
  // Must be published within last 5 years
  if (publishedAt < fiveYearsAgo) return false;
  
  // Channel must have 1K+ subscribers (if available)
  // This is a basic quality filter
  
  return true;
}

async function getVideoTranscript(videoId: string): Promise<string> {
  // Simplified transcript fetching - in production, use youtube-transcript package
  // For now, return empty string and rely on video metadata
  return '';
}

async function analyzeVideoWithClaude(video: any, transcript: string) {
  const prompt = `Analyze this BJJ instructional video and provide a quality score.

Video Title: ${video.snippet?.title}
Channel: ${video.snippet?.channelTitle}
Description: ${video.snippet?.description?.slice(0, 500)}

Rate this video from 1-10 based on:
1. Instructional quality (clear, systematic teaching)
2. Technical accuracy
3. Production quality
4. Instructor credibility
5. Usefulness for learning

Respond in JSON format:
{
  "quality_score": 7.5,
  "instructor": "Instructor Name",
  "technique_category": "submissions|guards|passing|positions|escapes|takedowns",
  "technique_name": "Specific technique",
  "belt_level": "white|blue|purple|brown|black|all",
  "gi_preference": "gi|nogi|both",
  "is_instructional": true,
  "rejection_reason": null,
  "key_details": ["Detail 1", "Detail 2"]
}

If this is NOT an instructional video (vlog, competition footage without instruction, advertisement), set quality_score to 0 and is_instructional to false.`;

  try {
    const response = await anthropic.messages.create({
      model: 'claude-sonnet-4-20250514',
      max_tokens: 1000,
      messages: [{
        role: 'user',
        content: prompt
      }]
    });
    
    const content = response.content[0];
    if (content.type !== 'text') return null;
    
    const jsonMatch = content.text.match(/\{[\s\S]*\}/);
    if (!jsonMatch) return null;
    
    const analysis = JSON.parse(jsonMatch[0]);
    
    if (!analysis.is_instructional || analysis.quality_score < 6.0) {
      return null;
    }
    
    return analysis;
    
  } catch (error) {
    console.error('Claude analysis error:', error);
    return null;
  }
}

async function addVideoToLibrary(video: any, analysis: any, runId: number, searchQueueId: number) {
  const instructor = await getInstructorByName(analysis.instructor);
  const featuredInstructor = instructor ? await getFeaturedInstructorByInstructorId(instructor.id) : null;
  
  // Determine tier based on quality
  let tier = 'tier_2';
  if (analysis.quality_score >= 8.5) tier = 'tier_1';
  else if (analysis.quality_score < 7.5) tier = 'tier_3';
  
  // Auto-publish if quality >= 7.5
  const autoPublished = analysis.quality_score >= 7.5;
  
  await sql`
    INSERT INTO ai_video_knowledge (
      video_id, title, instructor, url, description,
      technique_category, technique_name, difficulty_level,
      gi_preference, quality_score, key_details,
      tier, curation_run_id, auto_published, featured_instructor_id
    ) VALUES (
      ${video.id}, ${video.snippet?.title}, ${analysis.instructor},
      ${'https://youtube.com/watch?v=' + video.id}, ${video.snippet?.description},
      ${analysis.technique_category}, ${analysis.technique_name}, ${analysis.belt_level},
      ${analysis.gi_preference}, ${analysis.quality_score}, ${analysis.key_details},
      ${tier}, ${runId}, ${autoPublished}, ${featuredInstructor?.id || null}
    )
    ON CONFLICT (video_id) DO NOTHING
  `;
  
  // Update instructor stats
  if (instructor) {
    await sql`
      UPDATE instructor_credibility 
      SET videos_in_library = videos_in_library + 1
      WHERE id = ${instructor.id}
    `;
  }
  
  // Update featured instructor stats
  if (featuredInstructor) {
    await sql`
      UPDATE featured_instructors
      SET total_recommendations = total_recommendations + 1
      WHERE id = ${featuredInstructor.id}
    `;
  }
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SMART SEARCH GENERATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

export async function generateSmartSearches() {
  console.log('üß† Generating smart searches...');
  
  // Detect user request gaps
  const userGaps = await detectUserRequestGaps();
  
  // Check YouTube trending
  const youtubeTrends = await checkYouTubeTrends();
  
  // Find coverage gaps
  const coverageGaps = await findCoverageGaps();
  
  let generatedCount = 0;
  
  // Generate searches for user gaps (Priority 10)
  for (const gap of userGaps) {
    const searches = await generateSearchesForTechnique(gap.technique, 'user_gap', 10);
    generatedCount += searches.length;
  }
  
  // Generate searches for YouTube trends (Priority 9)
  for (const trend of youtubeTrends) {
    if (trend.trend_score > 70) {
      const searches = await generateSearchesForTechnique(trend.technique, 'youtube_trend', 9);
      generatedCount += searches.length;
    }
  }
  
  // Generate searches for coverage gaps (Priority 8)
  for (const gap of coverageGaps) {
    if (gap.videos_in_library < 5) {
      const searches = await generateSearchesForTechnique(gap.technique_name, 'coverage_gap', 8);
      generatedCount += searches.length;
    }
  }
  
  console.log(`‚úÖ Generated ${generatedCount} smart searches`);
  
  return { generatedCount };
}

async function detectUserRequestGaps() {
  const gaps = await sql`
    SELECT 
      technique_mentioned as technique,
      COUNT(*) as request_count,
      COUNT(DISTINCT user_id) as unique_users
    FROM user_technique_requests
    WHERE requested_at > NOW() - INTERVAL '7 days'
      AND was_gap = false
    GROUP BY technique_mentioned
    HAVING COUNT(*) >= 3
    ORDER BY COUNT(*) DESC
    LIMIT 10
  `;
  
  const gapsWithVideos = [];
  
  for (const gap of gaps) {
    const videoCount = await sql`
      SELECT COUNT(*) as count 
      FROM ai_video_knowledge 
      WHERE technique_name ILIKE ${'%' + gap.technique + '%'}
        OR technique_category ILIKE ${'%' + gap.technique + '%'}
    `;
    
    if (parseInt(videoCount[0].count) < 5) {
      gapsWithVideos.push({
        technique: gap.technique,
        request_count: gap.request_count,
        video_count: parseInt(videoCount[0].count)
      });
    }
  }
  
  return gapsWithVideos;
}

async function checkYouTubeTrends() {
  // Simplified YouTube trend checking
  // In production, track search volume changes over time
  
  const techniques = [
    'bodylock passing', 'saddle position', 'heel hook defense',
    '50/50 guard', 'leg drag', 'k-guard', 'false reap'
  ];
  
  const trends = [];
  
  for (const technique of techniques) {
    try {
      const searchResults = await youtubeClient.search.list({
        part: ['snippet'],
        q: `${technique} BJJ`,
        type: ['video'],
        maxResults: 5,
        publishedAfter: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
      });
      
      const recentVideos = searchResults.data.items?.length || 0;
      
      // Simple trend score based on recent activity
      const trendScore = recentVideos * 20; // 0-100 scale
      
      if (trendScore > 50) {
        trends.push({
          technique,
          trend_score: trendScore,
          recent_videos: recentVideos
        });
      }
    } catch (error) {
      console.error(`Error checking trend for ${technique}:`, error);
    }
  }
  
  return trends;
}

async function findCoverageGaps() {
  const categories = ['submissions', 'guards', 'passing', 'positions', 'escapes', 'takedowns'];
  const gaps = [];
  
  for (const category of categories) {
    const count = await sql`
      SELECT COUNT(*) as count 
      FROM ai_video_knowledge 
      WHERE technique_category = ${category}
    `;
    
    const videoCount = parseInt(count[0].count);
    const target = 100; // Target videos per category
    
    if (videoCount < target * 0.5) {
      gaps.push({
        technique_name: category,
        videos_in_library: videoCount,
        target: target,
        priority: videoCount < 10 ? 10 : 8
      });
    }
  }
  
  return gaps;
}

async function generateSearchesForTechnique(technique: string, reason: string, priority: number) {
  // Get top instructors for this technique
  const instructors = await sql`
    SELECT ic.name, ic.specialties
    FROM instructor_credibility ic
    WHERE ic.tier = 1
      AND ${technique} = ANY(ic.specialties)
    LIMIT 3
  `;
  
  const searches = [];
  
  // Generate instructor-specific searches
  for (const instructor of instructors) {
    const query = `${instructor.name} ${technique} fundamentals`;
    searches.push({
      search_query: query,
      category: getCategoryForTechnique(technique),
      priority,
      search_type: 'ai_generated',
      generated_reason: reason,
      instructor_focus: instructor.name,
      technique_focus: technique
    });
  }
  
  // Generate general searches
  searches.push({
    search_query: `${technique} step by step`,
    category: getCategoryForTechnique(technique),
    priority,
    search_type: 'ai_generated',
    generated_reason: reason,
    technique_focus: technique
  });
  
  searches.push({
    search_query: `${technique} details`,
    category: getCategoryForTechnique(technique),
    priority,
    search_type: 'ai_generated',
    generated_reason: reason,
    technique_focus: technique
  });
  
  // Insert searches into queue
  for (const search of searches) {
    await sql`
      INSERT INTO curation_search_queue ${sql(search)}
      ON CONFLICT DO NOTHING
    `;
  }
  
  return searches;
}

function getCategoryForTechnique(technique: string): string {
  const lowerTechnique = technique.toLowerCase();
  
  if (lowerTechnique.includes('pass')) return 'passing';
  if (lowerTechnique.includes('guard')) return 'guards';
  if (lowerTechnique.includes('choke') || lowerTechnique.includes('lock') || lowerTechnique.includes('bar')) return 'submissions';
  if (lowerTechnique.includes('escape')) return 'escapes';
  if (lowerTechnique.includes('takedown') || lowerTechnique.includes('throw')) return 'takedowns';
  if (lowerTechnique.includes('mount') || lowerTechnique.includes('back') || lowerTechnique.includes('side')) return 'positions';
  
  return 'fundamentals';
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// HELPER FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

async function createCurationRun(runType: string) {
  const result = await sql`
    INSERT INTO curation_runs (run_type, status)
    VALUES (${runType}, 'running')
    RETURNING id
  `;
  return result[0].id;
}

async function updateCurationRun(runId: number, updates: any) {
  await sql`
    UPDATE curation_runs 
    SET ${sql(updates)}
    WHERE id = ${runId}
  `;
}

async function getNextSearches() {
  const settings = await getCurationSettings();
  const searchesPerRun = parseInt(settings.searches_per_run);
  
  // Get searches in priority order
  const searches = await sql`
    SELECT * FROM curation_search_queue
    WHERE executed = false
    ORDER BY priority DESC, created_at ASC
    LIMIT ${searchesPerRun}
  `;
  
  return searches;
}

async function getCurationSettings() {
  const settings = await sql`SELECT setting_name, setting_value FROM curation_settings`;
  return Object.fromEntries(settings.map((s: any) => [s.setting_name, s.setting_value]));
}

async function getInstructorByName(name: string) {
  const result = await sql`
    SELECT * FROM instructor_credibility 
    WHERE name ILIKE ${name}
    LIMIT 1
  `;
  return result[0] || null;
}

async function getFeaturedInstructorByInstructorId(instructorId: number) {
  const result = await sql`
    SELECT * FROM featured_instructors
    WHERE instructor_id = ${instructorId}
      AND is_active = true
    LIMIT 1
  `;
  return result[0] || null;
}

async function pauseCuration() {
  await sql`
    UPDATE curation_settings
    SET setting_value = 'false'
    WHERE setting_name = 'curation_active'
  `;
}

async function createAlert(type: string, message: string) {
  console.warn(`üö® ALERT [${type}]: ${message}`);
  // In production, store in alerts table and/or send notifications
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// SCHEDULED CURATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

export async function startScheduledCuration() {
  const settings = await getCurationSettings();
  
  if (settings.curation_active !== 'true') {
    console.log('‚è∏Ô∏è Curation is paused');
    return;
  }
  
  const schedule = JSON.parse(settings.run_schedule);
  
  // Set up intervals for each scheduled time
  setInterval(async () => {
    const now = new Date();
    const currentTime = `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
    
    if (schedule.includes(currentTime)) {
      console.log(`‚è∞ Scheduled curation run at ${currentTime}`);
      try {
        await executeCurationRun('scheduled');
      } catch (error) {
        console.error('Scheduled curation failed:', error);
      }
    }
  }, 60000); // Check every minute
  
  console.log(`‚úÖ Curation scheduler started. Runs at: ${schedule.join(', ')}`);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// WEEK 1 SPECIFIC LOGIC
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

export async function startWeek1Curation() {
  console.log('üöÄ Starting Week 1 aggressive curation...');
  
  await sql`
    UPDATE curation_settings
    SET setting_value = 'true'
    WHERE setting_name = 'week_1_active'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = ${new Date().toISOString()}
    WHERE setting_name = 'week_1_start_date'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = '1'
    WHERE setting_name = 'week_1_current_day'
  `;
  
  // Set Week 1 schedule (4 runs per day)
  await sql`
    UPDATE curation_settings
    SET setting_value = '["06:00", "12:00", "18:00", "00:00"]'
    WHERE setting_name = 'run_schedule'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = '25'
    WHERE setting_name = 'searches_per_run'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = 'true'
    WHERE setting_name = 'curation_active'
  `;
  
  console.log('‚úÖ Week 1 curation activated (4 runs/day, 25 searches/run)');
  
  return { success: true, message: 'Week 1 curation started' };
}

export async function switchToPostWeek1Mode() {
  console.log('üîÑ Switching to post-Week 1 maintenance mode...');
  
  await sql`
    UPDATE curation_settings
    SET setting_value = 'false'
    WHERE setting_name = 'week_1_active'
  `;
  
  // Set post-Week 1 schedule (3 runs per day)
  await sql`
    UPDATE curation_settings
    SET setting_value = '["08:00", "14:00", "20:00"]'
    WHERE setting_name = 'run_schedule'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = '30'
    WHERE setting_name = 'searches_per_run'
  `;
  
  await sql`
    UPDATE curation_settings
    SET setting_value = 'ultra_aggressive'
    WHERE setting_name = 'curation_mode'
  `;
  
  console.log('‚úÖ Switched to ultra-aggressive maintenance (3 runs/day, 30 searches/run)');
  
  return { success: true, message: 'Switched to post-Week 1 mode' };
}
```

‚úì CHECKPOINT 6: Curation engine built. Core curation logic, smart search generation, and YouTube meta monitoring complete.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 7: ADMIN DASHBOARDS (45 min)

Create 4 admin dashboard pages: Meta Insights, Curation Control, Curation Settings, Instructor Partnerships.

### 7.1 Add routes to server/routes.ts

```typescript
import { executeCurationRun, generateSmartSearches, startWeek1Curation, switchToPostWeek1Mode } from './curation-engine';

// Add these routes:

// Curation control endpoints
app.post('/api/admin/curation/start-week-1', async (req, res) => {
  try {
    const result = await startWeek1Curation();
    res.json(result);
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/curation/run-now', async (req, res) => {
  try {
    const result = await executeCurationRun('manual');
    res.json(result);
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/curation/run-test', async (req, res) => {
  try {
    // Run with only 1 search for testing
    const result = await executeCurationRun('test');
    res.json(result);
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/curation/pause', async (req, res) => {
  try {
    await sql`UPDATE curation_settings SET setting_value = 'false' WHERE setting_name = 'curation_active'`;
    res.json({ success: true, message: 'Curation paused' });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/curation/resume', async (req, res) => {
  try {
    await sql`UPDATE curation_settings SET setting_value = 'true' WHERE setting_name = 'curation_active'`;
    res.json({ success: true, message: 'Curation resumed' });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/api/admin/curation/status', async (req, res) => {
  try {
    const settings = await sql`SELECT setting_name, setting_value FROM curation_settings`;
    const settingsObj = Object.fromEntries(settings.map((s: any) => [s.setting_name, s.setting_value]));
    
    const libraryStats = await sql`
      SELECT 
        COUNT(*) as total_videos,
        COUNT(*) FILTER (WHERE auto_published = true) as published_videos,
        AVG(quality_score) as avg_quality,
        COUNT(*) FILTER (WHERE quality_score >= 8.5) as tier1_count,
        COUNT(*) FILTER (WHERE quality_score >= 7.5 AND quality_score < 8.5) as tier2_count,
        COUNT(*) FILTER (WHERE quality_score >= 7.0 AND quality_score < 7.5) as tier3_count
      FROM ai_video_knowledge
    `;
    
    const recentRuns = await sql`
      SELECT * FROM curation_runs 
      ORDER BY run_date DESC 
      LIMIT 10
    `;
    
    res.json({
      settings: settingsObj,
      library: libraryStats[0],
      recentRuns
    });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/api/admin/meta-insights', async (req, res) => {
  try {
    // User request patterns
    const userRequests = await sql`
      SELECT 
        technique_mentioned,
        COUNT(*) as request_count,
        COUNT(DISTINCT user_id) as unique_users
      FROM user_technique_requests
      WHERE requested_at > NOW() - INTERVAL '7 days'
      GROUP BY technique_mentioned
      ORDER BY COUNT(*) DESC
      LIMIT 10
    `;
    
    // Coverage by category
    const coverage = await sql`
      SELECT 
        technique_category,
        COUNT(*) as video_count,
        AVG(quality_score) as avg_quality,
        AVG(helpful_ratio) as avg_helpful_ratio
      FROM ai_video_knowledge
      WHERE technique_category IS NOT NULL
      GROUP BY technique_category
      ORDER BY video_count DESC
    `;
    
    // Trending techniques from meta table
    const trending = await sql`
      SELECT *
      FROM technique_meta_status
      WHERE meta_status IN ('hot', 'rising')
      ORDER BY overall_meta_score DESC
      LIMIT 10
    `;
    
    res.json({
      userRequests,
      coverage,
      trending
    });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.get('/api/admin/featured-instructors', async (req, res) => {
  try {
    const featured = await sql`
      SELECT 
        fi.*,
        ic.name as instructor_name,
        ic.specialties
      FROM featured_instructors fi
      JOIN instructor_credibility ic ON fi.instructor_id = ic.id
      WHERE fi.is_active = true
      ORDER BY 
        CASE fi.feature_level
          WHEN 'primary' THEN 1
          WHEN 'secondary' THEN 2
          WHEN 'spotlight' THEN 3
        END
    `;
    
    res.json(featured);
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/featured-instructors/add', async (req, res) => {
  try {
    const { instructorName, featureLevel, duration, partnershipNotes } = req.body;
    
    const instructor = await sql`
      SELECT id FROM instructor_credibility WHERE name = ${instructorName}
    `;
    
    if (instructor.length === 0) {
      return res.status(404).json({ error: 'Instructor not found' });
    }
    
    const boost = featureLevel === 'primary' ? 50 : featureLevel === 'secondary' ? 30 : 15;
    const priority = featureLevel === 'primary' ? 20 : featureLevel === 'secondary' ? 10 : 5;
    const endDate = duration === 'permanent' ? null : new Date(Date.now() + duration * 24 * 60 * 60 * 1000);
    
    await sql`
      INSERT INTO featured_instructors (
        instructor_id, feature_level, search_priority_percentage,
        recommendation_boost_percentage, end_date, partnership_notes
      ) VALUES (
        ${instructor[0].id}, ${featureLevel}, ${priority},
        ${boost}, ${endDate}, ${partnershipNotes}
      )
    `;
    
    res.json({ success: true, message: 'Featured instructor added' });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});

app.post('/api/admin/curation/settings/update', async (req, res) => {
  try {
    const { settings } = req.body;
    
    for (const [key, value] of Object.entries(settings)) {
      await sql`
        UPDATE curation_settings
        SET setting_value = ${String(value)}, updated_at = NOW()
        WHERE setting_name = ${key}
      `;
    }
    
    res.json({ success: true, message: 'Settings updated' });
  } catch (error: any) {
    res.status(500).json({ error: error.message });
  }
});
```

### 7.2 Create admin pages (client/src/pages/admin/)

Create these React components for admin pages. Since this is getting very long, I‚Äôll provide the key structure:

**AdminMetaInsights.tsx** - Shows trending techniques, user requests, coverage gaps
**AdminCurationControl.tsx** - Start/stop curation, view logs, manual controls  
**AdminCurationSettings.tsx** - Speed presets, percentage sliders, featured instructors
**AdminPartnerships.tsx** - Featured instructor management, exposure calculator

‚úì CHECKPOINT 7: Admin dashboards created. Visit /admin/meta-insights, /admin/curation-control, /admin/curation-settings, /admin/partnerships to verify all pages load.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## SECTION 8: TESTING & VALIDATION (15 min)

### 8.1 Automated tests

Create file `tests/prompt-10-validation.test.ts`:

```typescript
import { sql } from '../server/db';

async function runValidationTests() {
  console.log('üß™ Running Prompt 10 validation tests...\n');
  
  let passed = 0;
  let failed = 0;
  
  // Test 1: Database tables exist
  try {
    await sql`SELECT 1 FROM instructor_credibility LIMIT 1`;
    await sql`SELECT 1 FROM curation_search_queue LIMIT 1`;
    await sql`SELECT 1 FROM featured_instructors LIMIT 1`;
    console.log('‚úÖ Test 1: Database tables exist');
    passed++;
  } catch (error) {
    console.error('‚ùå Test 1 FAILED: Database tables missing');
    failed++;
  }
  
  // Test 2: Instructors populated
  try {
    const count = await sql`SELECT COUNT(*) as count FROM instructor_credibility`;
    if (parseInt(count[0].count) >= 100) {
      console.log(`‚úÖ Test 2: Instructors populated (${count[0].count} instructors)`);
      passed++;
    } else {
      console.error(`‚ùå Test 2 FAILED: Only ${count[0].count} instructors (expected 100+)`);
      failed++;
    }
  } catch (error) {
    console.error('‚ùå Test 2 FAILED:', error);
    failed++;
  }
  
  // Test 3: JT Torres marked as user's instructor
  try {
    const jt = await sql`
      SELECT * FROM instructor_credibility 
      WHERE name = 'JT Torres' AND is_user_instructor = true
    `;
    if (jt.length > 0) {
      console.log('‚úÖ Test 3: JT Torres marked as user instructor');
      passed++;
    } else {
      console.error('‚ùå Test 3 FAILED: JT Torres not marked as user instructor');
      failed++;
    }
  } catch (error) {
    console.error('‚ùå Test 3 FAILED:', error);
    failed++;
  }
  
  // Test 4: Week 1 searches queued
  try {
    const count = await sql`
      SELECT COUNT(*) as count FROM curation_search_queue 
      WHERE week_number = 1
    `;
    if (parseInt(count[0].count) === 175) {
      console.log(`‚úÖ Test 4: Week 1 searches queued (175 searches)`);
      passed++;
    } else {
      console.error(`‚ùå Test 4 FAILED: ${count[0].count} searches (expected 175)`);
      failed++;
    }
  } catch (error) {
    console.error('‚ùå Test 4 FAILED:', error);
    failed++;
  }
  
  // Test 5: Featured instructors set up
  try {
    const featured = await sql`SELECT COUNT(*) as count FROM featured_instructors WHERE is_active = true`;
    if (parseInt(featured[0].count) === 3) {
      console.log('‚úÖ Test 5: Featured instructors configured (3 active)');
      passed++;
    } else {
      console.error(`‚ùå Test 5 FAILED: ${featured[0].count} featured (expected 3)`);
      failed++;
    }
  } catch (error) {
    console.error('‚ùå Test 5 FAILED:', error);
    failed++;
  }
  
  // Test 6: Curation settings populated
  try {
    const settings = await sql`SELECT COUNT(*) as count FROM curation_settings`;
    if (parseInt(settings[0].count) >= 20) {
      console.log(`‚úÖ Test 6: Curation settings configured (${settings[0].count} settings)`);
      passed++;
    } else {
      console.error(`‚ùå Test 6 FAILED: Only ${settings[0].count} settings`);
      failed++;
    }
  } catch (error) {
    console.error('‚ùå Test 6 FAILED:', error);
    failed++;
  }
  
  console.log(`\nüìä Test Results: ${passed} passed, ${failed} failed`);
  
  if (failed === 0) {
    console.log('\nüéâ ALL TESTS PASSED! Prompt 10 is ready.\n');
  } else {
    console.log('\n‚ö†Ô∏è Some tests failed. Review errors above.\n');
  }
}

runValidationTests();
```

### 8.2 Manual test checklist

After build completes, test these manually:

```
MANUAL TESTING CHECKLIST FOR PROMPT 10:

‚ñ° Database Tests:
  ‚ñ° Run: SELECT COUNT(*) FROM instructor_credibility;
     Expected: 110+ instructors
  
  ‚ñ° Run: SELECT * FROM instructor_credibility WHERE name = 'JT Torres';
     Expected: Shows JT Torres with is_user_instructor = true
  
  ‚ñ° Run: SELECT COUNT(*) FROM curation_search_queue WHERE week_number = 1;
     Expected: 175 searches
  
  ‚ñ° Run: SELECT day_number, COUNT(*) FROM curation_search_queue WHERE week_number = 1 GROUP BY day_number;
     Expected: 25 searches for each day 1-7

‚ñ° Admin Dashboard Tests:
  ‚ñ° Visit /admin/meta-insights
     Expected: Page loads, shows library stats
  
  ‚ñ° Visit /admin/curation-control  
     Expected: Page loads, shows "Start Week 1" button
  
  ‚ñ° Visit /admin/curation-settings
     Expected: Page loads, shows speed presets and sliders
  
  ‚ñ° Visit /admin/partnerships
     Expected: Page loads, shows JT Torres, Gordon Ryan, Lachlan Giles

‚ñ° Featured Instructor Tests:
  ‚ñ° Run: SELECT ic.name, fi.feature_level, fi.recommendation_boost_percentage 
         FROM featured_instructors fi 
         JOIN instructor_credibility ic ON fi.instructor_id = ic.id;
     Expected: JT Torres (primary, 50%), Gordon Ryan (secondary, 30%), Lachlan Giles (secondary, 30%)

‚ñ° Curation Control Tests:
  ‚ñ° Click "Run Single Test Search" in admin dashboard
     Expected: Executes 1 search, adds videos if found
  
  ‚ñ° Check curation_runs table after test:
     Run: SELECT * FROM curation_runs ORDER BY run_date DESC LIMIT 1;
     Expected: Shows completed test run with stats

‚ñ° Smart Search Tests:
  ‚ñ° Manually trigger smart search generation (if API endpoint exists)
     Expected: Generates searches based on gaps
  
  ‚ñ° Check: SELECT COUNT(*) FROM curation_search_queue WHERE search_type = 'ai_generated';
     Expected: Shows AI-generated searches (if any gaps detected)

IF ALL TESTS PASS:
‚úÖ Prompt 10 is complete and ready for Week 1 curation launch!

TO START WEEK 1 CURATION:
1. Go to /admin/curation-control
2. Click "Start Week 1 Curation" button
3. System will run 4 times per day (6am, 12pm, 6pm, 12am)
4. Monitor progress in admin dashboard
5. After 7 days, system will have ~1,000 videos
6. Can manually switch to post-Week 1 mode or it auto-switches
```

‚úì CHECKPOINT 8: Testing complete. Run automated tests, then work through manual checklist.

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## FINAL: SYSTEM READY

If all checkpoints passed:

1. Database schema created ‚úÖ
1. 110+ instructors populated ‚úÖ
1. 175 Week 1 searches queued ‚úÖ
1. Featured instructors configured ‚úÖ
1. Curation engine built ‚úÖ
1. Smart search generation ready ‚úÖ
1. YouTube meta monitoring active ‚úÖ
1. Admin dashboards functional ‚úÖ

**üéâ PROMPT 10 COMPLETE! üéâ**

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

## NEXT STEPS:

**When you‚Äôre ready to launch Week 1 curation:**

1. Test the system with ‚ÄúRun Single Test Search‚Äù
1. Verify videos are being added correctly
1. Click ‚ÄúStart Week 1 Curation‚Äù
1. System runs automatically for 7 days
1. After Week 1, manually switch to ‚ÄúUltra-Aggressive‚Äù maintenance mode
1. System continues running forever at 90 searches/day

**To monitor:**

- Check /admin/meta-insights daily for trends
- Check /admin/curation-control for run logs
- Adjust settings in /admin/curation-settings as needed

**The moat is being built automatically.** üè∞

Good night! Wake up to a fully automated curation system. üåô‚ú®

```
---

**Copy everything above this line and paste into Replit Agent.**

Then go to bed. Sleep well. Wake up to BJJ OS 2.0. üöÄüí§‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã‚Äã
```