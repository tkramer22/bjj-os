```
COMPLETE BJJ OS REDESIGN - MOBILE-FIRST JAPANESE MINIMALISM + ALL BUG FIXES

DESIGN PHILOSOPHY:
- Mobile-first (375px iPhone first, then scale to desktop)
- Japanese minimalism (ma, kanso, shizen, seijaku)
- Custom, premium, expensive look
- Intelligence shown through subtle factual statements
- Huge breathing room, generous spacing
- Excellence is our pillar - every pixel matters

===================================
PART 1: ONBOARDING FLOW FIX
===================================

CRITICAL BUG: Users are being forced through onboarding multiple times, or skipping it entirely. This must be fixed.

USER TYPES:
1. Regular User: Enters phone number, SMS verification required
2. Lifetime Member (Admin-granted): Special access, NO SMS verification required

CORRECT AUTHENTICATION FLOW:

First-Time Regular User (phone number NOT in database):
1. User enters phone number
2. SMS verification code sent via Twilio
3. User verifies code
4. System checks database: Does phone_number exist?
   - NO â†’ User is new, proceed to onboarding
5. Show 4-step onboarding (details below)
6. After completion, save to database and set onboarding_completed = true
7. Redirect to /chat

First-Time Lifetime Member (admin-granted, NO SMS):
1. Admin creates account with email or username
2. Admin sets subscription_tier = "lifetime" and granted_by_admin = true
3. User receives access link
4. User clicks link, accesses app (no SMS verification)
5. System checks: onboarding_completed?
   - NO â†’ Show 4-step onboarding (same as regular users)
6. After completion, save to database and set onboarding_completed = true
7. Redirect to /chat

Returning Regular User (phone number EXISTS in database):
1. User enters phone number
2. SMS verification code sent
3. User verifies code
4. System checks database: onboarding_completed = true?
   - YES â†’ Load full user profile from database
   - Skip onboarding completely
   - Redirect directly to /chat with all context loaded

Returning Lifetime Member (already completed onboarding):
1. User accesses app (no SMS needed)
2. System checks database: onboarding_completed = true?
   - YES â†’ Load full user profile from database
   - Skip onboarding completely
   - Redirect directly to /chat with all context loaded

4-STEP ONBOARDING (ONE TIME ONLY, NEVER SHOWN AGAIN):

Step 1: Username
- Page title: "Welcome to BJJ OS" (32px, white 100%, bold, centered)
- Progress indicator: "Step 1 of 4" (12px, white 60%, centered, above title)
- Question: "Choose your username" (18px, white 90%, centered)
- Input field: Text input, 3-20 characters, alphanumeric only, no spaces
- Validation: Real-time check if username exists in database
- Error message: "Username already taken. Try another." (red #DC2626)
- Next button: Disabled until valid unique username entered
- Style: Same minimal design as welcome message (centered, dark box, generous padding)

Step 2: Belt Level
- Progress indicator: "Step 2 of 4"
- Question: "What's your current belt level?" (18px, white 90%, centered)
- Options: Display 5 belt graphics (actual belt images, not just text)
  - White Belt (with belt graphic)
  - Blue Belt (with belt graphic)
  - Purple Belt (with belt graphic)
  - Brown Belt (with belt graphic)
  - Black Belt (with belt graphic)
- Selection: Click to select, selected belt gets blue border #2563EB
- Belt graphics: 400px Ã— 60px, same as landing page animation
- Mobile: Stack vertically, 16px gap between options
- Desktop: Could show in grid or keep stacked

Step 3: Training Style
- Progress indicator: "Step 3 of 4"
- Question: "What do you train?" (18px, white 90%, centered)
- Options: Large button selection
  - Gi (button with icon ğŸ¥‹)
  - No-Gi (button with icon ğŸ¤¼)
  - Both (button with both icons)
- Button style: 
  - Background: #111113
  - Border: 1px solid #333333
  - Border radius: 12px
  - Padding: 20px
  - Height: 80px
  - Width: 100% on mobile, 33% on desktop
  - Selected: Blue border #2563EB, blue background 10% opacity
  - Font: 16px, white 90%, medium weight

Step 4: Training Frequency
- Progress indicator: "Step 4 of 4"
- Question: "How often do you train?" (18px, white 90%, centered)
- Dropdown: Select 1-7 days per week
- Dropdown style:
  - Background: #111113
  - Border: 1px solid #333333
  - Border radius: 12px
  - Padding: 16px
  - Height: 56px
  - Font: 16px, white 90%
  - Centered, max-width 300px
- Options: "1 day per week", "2 days per week", ... "7 days per week"
- Finish button: "Complete Setup" (blue #2563EB, full width on mobile, centered on desktop)

After Onboarding Completion:
- Save to database:
  - username
  - belt_level
  - training_style
  - training_frequency
  - phone_number (if regular user)
  - email (if lifetime member)
  - onboarding_completed = true
  - subscription_tier = "paid" or "lifetime"
  - granted_by_admin = true/false
  - created_at = now()
- Show success message: "Welcome to BJJ OS, [username]!" (fade out after 2 seconds)
- Redirect to /chat

Database Schema Required:

users table:
- id (UUID, primary key)
- phone_number (STRING, UNIQUE, NULLABLE) - null for lifetime members without phone
- email (STRING, UNIQUE, NULLABLE) - for lifetime members
- username (STRING, UNIQUE, NOT NULL)
- belt_level (STRING, NOT NULL) - White/Blue/Purple/Brown/Black
- training_style (STRING, NOT NULL) - Gi/No-Gi/Both
- training_frequency (INTEGER, NOT NULL) - 1-7
- onboarding_completed (BOOLEAN, default false)
- subscription_tier (STRING, NOT NULL) - "paid" or "lifetime"
- granted_by_admin (BOOLEAN, default false)
- created_at (TIMESTAMP, default now())
- total_logins (INTEGER, default 0)
- current_streak (INTEGER, default 0)
- last_login_date (DATE)

CRITICAL RULES:
- Onboarding happens ONCE per user, EVER
- After onboarding_completed = true, NEVER show onboarding again
- Lifetime and paid members have IDENTICAL features (no differences in UI or functionality)
- Lifetime members do NOT require SMS verification
- Regular users ALWAYS require SMS verification
- All users complete same 4-step onboarding on first access
- Returning users skip directly to /chat with profile loaded

===================================
PART 2: CHAT PAGE REDESIGN
===================================

DESIGN: Mobile-first Japanese minimalism

HEADER (sticky at top):

Mobile (375px):
- "Prof. OS" (20px, white 100%, bold, centered)
- "Learns your game. Makes you better." (13px, white 70%, regular, centered, line-height 1.6)
- Background: #0A0A0B
- Height: 80px
- Border-bottom: 1px solid #1A1A1C
- Position: sticky, top: 0, z-index: 100

Desktop (768px+):
- Same design, slightly larger text
- "Prof. OS": 24px
- Subtitle: 14px
- Max-width: 100%, centered content

WELCOME MESSAGE (first-time chat):

Mobile Content (375px):
```

```
  Prof. OS           
```

Iâ€™ve analyzed 10,000+  
videos from elite  
instructors.

I track patterns in  
your training you  
canâ€™t see.

I remember every  
detail you share.

The more we talk,  
the smarter I get  
about YOUR jiu jitsu.

What did you work  
on today?

```
Mobile Box Style (375px):
- Background: #0A0A0B
- Border: 1px solid #1A1A1C
- Border radius: 12px
- Padding: 40px 20px (vertical generous, horizontal tight for mobile)
- Margin: 20px (sides)
- Drop shadow: 0 4px 20px rgba(0,0,0,0.5)
- Center aligned text

Desktop Box Style (768px+):
- Same design
- Max width: 600px, centered on screen
- Padding: 60px 40px (more generous)
- Margin: 40px auto

Typography (Mobile 375px):
- "Prof. OS": 24px, white 100%, medium weight
- Capability statements (3 lines): 15px, white 90%, regular, line-height 1.8
- Relationship statement: 15px, white 85%, regular, line-height 1.8
- CTA question: 16px, white 100%, medium weight
- Letter spacing: 0.02em (slightly loose)
- Center aligned

Typography (Desktop 768px+):
- "Prof. OS": 28px, white 100%, medium weight
- Capability statements: 16px, white 90%, regular, line-height 1.8
- Relationship statement: 16px, white 85%, regular, line-height 1.8
- CTA question: 18px, white 100%, medium weight
- Letter spacing: 0.02em
- Center aligned

Spacing (Mobile):
- 20px from header to message box top
- Inside message box:
  - 40px top padding
  - "Prof. OS" title
  - 32px space
  - First capability statement ("I've analyzed 10,000+...")
  - 24px space
  - Second capability statement ("I track patterns...")
  - 24px space
  - Third capability statement ("I remember every detail...")
  - 40px space
  - Relationship statement ("The more we talk...")
  - 60px space
  - CTA question ("What did you work on today?")
  - 40px bottom padding
- 20px from message box to input area

Spacing (Desktop):
- Same structure, more generous
- 60px top padding
- 80px space before CTA question
- 60px bottom padding

INPUT AREA (fixed at bottom):

Mobile Layout (375px):
- Text input field at top
- Voice button (ğŸ¤) positioned inside input on right side
- Send button below input, full width

Style:
- Position: fixed, bottom: 0, left: 0, right: 0
- Background: #0A0A0B
- Border-top: 1px solid #1A1A1C
- Padding: 16px
- Safe area insets: padding-bottom: calc(16px + env(safe-area-inset-bottom))
- z-index: 1000

Input Field:
- Background: #111113
- Border: 1px solid #333333
- Border radius: 24px
- Padding: 12px 56px 12px 20px (extra right padding for voice button)
- Font size: 16px (prevents iOS zoom on focus)
- Color: white 100%
- Placeholder: "Ask Prof. OS..." (white 60%)
- Width: 100%
- Min height: 48px (touch target)

Voice Button:
- Position: absolute, right 12px inside input field
- Icon: ğŸ¤ or microphone SVG
- Size: 40px Ã— 40px (touch target)
- Color: white 70%
- Hover/active: white 100%
- Circular button
- Background: transparent
- No border

Send Button:
- Below input field, 8px margin top
- Full width
- Height: 48px (touch target)
- Background: blue #2563EB
- Color: white 100%
- Border radius: 24px
- Font: 16px, medium weight
- Text: "Send"
- Disabled state: gray #6B7280, white 60%

Desktop (768px+):
- Same design, max width 600px centered
- Input and buttons slightly larger (if needed)

CHAT MESSAGES (after conversation starts):

User Message (right side):
- Background: #2563EB (blue)
- Color: white 100%
- Border radius: 16px 16px 4px 16px (rounded except bottom-right)
- Padding: 12px 16px
- Max width: 75%
- Align: right
- Margin: 8px 20px 8px auto
- Font: 15px, regular
- Line-height: 1.5

Prof. OS Message (left side):
- Background: #111113 (dark gray)
- Color: white 90%
- Border radius: 16px 16px 16px 4px (rounded except bottom-left)
- Padding: 12px 16px
- Max width: 75%
- Align: left
- Margin: 8px auto 8px 20px
- Font: 15px, regular
- Line-height: 1.5

Timestamps:
- Below each message
- 12px, white 50%
- Right aligned for user messages, left aligned for Prof. OS messages
- Format: "9:45 AM" (within last 24 hours)
- Format: "Oct 22, 9:45 AM" (older than 24 hours)

Date Dividers:
- When day changes, show divider with date
- Text: "Today", "Yesterday", or "Oct 20"
- Style: 12px, white 50%, centered
- Margin: 20px top and bottom
- Optional: thin line on either side of text

Video Recommendations (within Prof. OS messages):

Card format embedded in Prof. OS message bubble:
- Background: #0A0A0B
- Border: 1px solid #1A1A1C
- Border radius: 8px
- Padding: 12px
- Margin: 8px 0 (inside Prof. OS message)

Card Contents:
- Thumbnail: 16:9 aspect ratio, 100% width, border-radius 6px
- Title: 14px, white 90%, bold, 2 lines max, ellipsis
- Instructor: 12px, blue #2563EB, 1 line
- Watch button: Blue #2563EB, full width, 36px height, border-radius 6px, text "Watch"
- Feedback icons: ğŸ‘ ğŸ‘ below watch button, small, gray (turn blue/red on click)

===================================
PART 3: SAVED VIDEOS PAGE
===================================

CRITICAL BUG FIX: Clicking "Saved Videos" in navigation currently routes to /welcome (onboarding). This is wrong.

CORRECT ROUTING:
- When user clicks "Saved Videos" in sidebar navigation
- Check if user is authenticated
- IF authenticated â†’ Route to /saved-videos (actual saved videos page)
- IF not authenticated â†’ Route to /login
- NEVER route to /welcome or onboarding

PAGE STRUCTURE:

Header:
- Title: "Saved Videos" (20px, white 100%, bold, centered)
- Background: #0A0A0B
- Height: 60px
- Border-bottom: 1px solid #1A1A1C

Filter Section (below header):

Mobile (375px) - Stacked Vertically:
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         â”‚
â”‚  Filter by Technique    â”‚
â”‚  [All Categories    â–¼]  â”‚
â”‚                         â”‚
â”‚  Filter by Instructor   â”‚
â”‚  [All Instructors   â–¼]  â”‚
â”‚                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
- Padding: 20px
- Background: #0A0A0B
- 12px gap between dropdowns

Desktop (768px+) - Side by Side:
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                       â”‚
â”‚  Filter by Technique    Filter by     â”‚
â”‚  [All Categories  â–¼]    Instructor    â”‚
â”‚                         [All Instr â–¼] â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
- Two columns, 50% width each, 12px gap
- Max-width: 1200px, centered
- Padding: 40px

Dropdown Style:
- Background: #111113
- Border: 1px solid #333333
- Border radius: 8px
- Padding: 12px 16px
- Font: 15px, white 90%
- Height: 48px (touch target)
- Chevron icon: white 60%, right side
- Full width on mobile

Category Dropdown Options:
- All Categories (default)
- Submissions
- Guard Passes
- Sweeps
- Escapes
- Takedowns
- Guard Retention
- Position Control
- Other

Instructor Dropdown Options:
- All Instructors (default)
- [Dynamically populated from user's saved videos]
- Alphabetically sorted list of unique instructors
- Example: Bernardo Faria, Gordon Ryan, John Danaher, Lachlan Giles, etc.

Filter Behavior:
- Both filters work together (AND logic)
- Real-time filtering (no Apply button needed)
- Examples:
  - Select "Submissions" + "All Instructors" â†’ Shows all submission videos
  - Select "All Categories" + "John Danaher" â†’ Shows all Danaher videos
  - Select "Submissions" + "John Danaher" â†’ Shows only Danaher submission videos
- If no results match: Show "No videos match these filters" message

Video Grid (below filters):

Mobile (375px) - Single Column:
- Grid: 1 column
- Gap: 16px between cards
- Padding: 20px
- Full width minus padding

Desktop (768px+) - Two Columns:
- Grid: 2 columns
- Gap: 20px between cards
- Padding: 40px
- Max-width: 1200px, centered

Video Card Design:

Structure:
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚      [16:9 Thumbnail]       â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  Triangle Setup from        â”‚
â”‚  Closed Guard               â”‚
â”‚                             â”‚
â”‚  John Danaher              â”‚
â”‚                             â”‚
â”‚  [Submissions]             â”‚
â”‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Watch   â”‚  â”‚    ğŸ—‘    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
Card Style:
- Background: #111113
- Border: 1px solid #333333
- Border radius: 12px
- Padding: 12px
- Hover: border changes to blue #2563EB
- Transition: 200ms ease

Thumbnail:
- 16:9 aspect ratio
- Width: 100% of card width
- Border radius: 8px
- Object-fit: cover
- Background: #0A0A0B (if image fails to load)

Video Title:
- Font: 15px, white 90%, bold
- Max 2 lines
- Text overflow: ellipsis
- Margin: 12px 0 8px 0

Instructor Name:
- Font: 13px, blue #2563EB
- 1 line, ellipsis if too long
- Margin: 0 0 8px 0

Category Badge:
- Inline pill style
- Border radius: 12px
- Padding: 4px 12px
- Font: 12px, white 100%, medium weight
- Margin: 0 0 12px 0
- Background colors by category:
  - Submissions: #DC2626 (red)
  - Guard Passes: #2563EB (blue)
  - Sweeps: #7C3AED (purple)
  - Escapes: #10B981 (green)
  - Takedowns: #F59E0B (orange)
  - Guard Retention: #06B6D4 (cyan)
  - Position Control: #EAB308 (yellow)
  - Other: #6B7280 (gray)

Watch Button:
- Background: #2563EB (blue)
- Color: white 100%
- Border: none
- Border radius: 8px
- Padding: 10px 20px
- Font: 14px, medium weight
- Text: "Watch"
- Flex: 1 (takes most of the space)
- Height: 40px
- Cursor: pointer
- Hover: background #1D4ED8 (darker blue)

Remove Button:
- Background: transparent
- Border: 1px solid #DC2626 (red)
- Color: #DC2626
- Border radius: 8px
- Padding: 10px
- Size: 40px Ã— 40px (square, touch target)
- Icon: ğŸ—‘ or trash SVG
- Cursor: pointer
- Hover: background #DC2626 10% opacity

Button Container:
- Display: flex
- Gap: 8px
- Margin-top: auto (pushes to bottom of card)

Empty State (no saved videos):

Structure:
```

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚
â”‚                             â”‚
â”‚                             â”‚
â”‚           ğŸ“š                â”‚
â”‚                             â”‚
â”‚     No saved videos yet     â”‚
â”‚                             â”‚
â”‚   Start chatting with       â”‚
â”‚   Prof. OS to get video     â”‚
â”‚   recommendations           â”‚
â”‚                             â”‚
â”‚                             â”‚
â”‚                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```
Style:
- Center aligned horizontally and vertically
- Icon: ğŸ“š or bookmark SVG, 64px size, white 30% opacity
- Title: "No saved videos yet" (20px, white 70%, medium weight)
- Subtitle: 15px, white 50%, regular, max-width 300px, center aligned
- Padding: 80px
- Appears in place of video grid

When User Saves a Video (from chat):
1. AI extracts from conversation:
   - Video URL
   - Video title
   - Instructor name (standardized format)
   - Category (based on technique discussed)
   - Thumbnail URL (if available)
2. Save to saved_videos table in database
3. Show success toast message: "Saved to [Category] - [Instructor]" (green, 3 seconds, top-right)
4. Video immediately appears in Saved Videos page

Database Schema:

saved_videos table:
- id (UUID, primary key)
- user_id (UUID, foreign key to users.id)
- video_url (STRING, NOT NULL)
- video_title (STRING, NOT NULL)
- instructor_name (STRING, NOT NULL) - standardized format
- category (STRING, NOT NULL) - must be one of 8 categories
- thumbnail_url (STRING, NULLABLE)
- saved_at (TIMESTAMP, default now())
- notes (TEXT, NULLABLE) - for future: user can add personal notes

===================================
PART 4: PROF. OS AI INTEGRATION
===================================

System Prompt Integration:

When Prof. OS generates a response, ALWAYS include user profile data in the AI context:
```

User Profile (loaded from database):

- Username: ${username}
- Belt Level: ${belt_level}
- Training Style: ${training_style}
- Training Frequency: ${training_frequency}x per week
- Member Since: ${created_at}
- Subscription Tier: ${subscription_tier}

IMPORTANT: Use this information to personalize every response.

- Tailor recommendations to their belt level
- Reference their training style (Gi/No-Gi/Both)
- Consider their training frequency when suggesting drills
- NEVER ask for this information again
- Treat lifetime and paid members identically (no feature differences)

```
Prof. OS Personality (from previous project discussions):
- Training partner who learns YOUR game (not a generic chatbot)
- Journey-focused language: "YOUR game", "YOUR journey", "YOUR development"
- Encourages sharing training details to improve recommendations
- Spots patterns in training over time
- Recommends 1-3 videos with specific context (not random search results)
- Black belt best friend tone: knowledgeable, supportive, direct
- Natural and conversational, never robotic or corporate
- References elite instructors naturally (Danaher, Marcelo, etc.)
- Thinks in systems and chains, not isolated techniques
- Celebrates progress, acknowledges struggles
- Makes user feel less alone in their BJJ journey

Chat Behavior:
- Always greet returning users: "Welcome back, [username]"
- Reference previous conversations when relevant
- Ask follow-up questions about techniques discussed before
- Track patterns: "This is the third time you've mentioned half guard..."
- Provide video recommendations WITH context, not just links
- Example: "For your half guard retention, check out this Lucas Leite breakdown. Pay attention to how he uses the underhook at 3:42."

Video Recommendations:
- Pull from ai_video_knowledge database (curated library)
- Filter by user's belt level and training style
- Include instructor name, category, and why it's relevant
- Provide specific timestamp if key moment exists
- Ask for feedback: "Was this helpful?" (thumbs up/down)
- Track helpful_count to improve future recommendations

===================================
PART 5: MOBILE OPTIMIZATION
===================================

Critical Mobile Requirements:
- Design for 375px width first (iPhone SE/13 mini)
- Touch targets: minimum 48px Ã— 48px
- Font size: minimum 16px for inputs (prevents iOS zoom on focus)
- Line length: 30-40 characters optimal for readability on mobile
- Safe area insets: 
  - padding-top: env(safe-area-inset-top) for iPhone notch
  - padding-bottom: env(safe-area-inset-bottom) for home indicator
- No horizontal scroll
- Fast load time (minimize heavy animations)
- Thumb-friendly layout (important actions in center/bottom third of screen)
- Keyboard handling: When keyboard opens, input field must stay visible

Responsive Breakpoints:
- Mobile: < 768px
- Desktop: â‰¥ 768px

Mobile Specific Considerations:
- No hover states on mobile (use active/pressed states instead)
- Larger tap targets than desktop click targets
- Simplified navigation (hamburger menu if needed)
- Full-width components on mobile
- Reduced padding/margins compared to desktop
- Single column layouts
- Bottom navigation or fixed input areas (easier thumb access)

===================================
PART 6: VISUAL EXCELLENCE STANDARDS
===================================

Typography:
- Font family: System font stack for performance
  - -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial
- Font rendering: -webkit-font-smoothing: antialiased
- Line heights: 1.5 for body text, 1.8 for welcome message
- Letter spacing: 0.02em for slight breathing room
- Hierarchy maintained through size and weight, not color variety

Colors:
- Background: #000000 (pure black)
- Elevated surfaces: #0A0A0B (very dark gray)
- Cards/inputs: #111113 (dark gray)
- Borders: #1A1A1C (subtle, barely visible) or #333333 (more visible)
- Text primary: white 100%
- Text secondary: white 90%
- Text tertiary: white 70%
- Text disabled: white 50%
- Accent blue: #2563EB
- Success green: #10B981
- Error red: #DC2626
- Warning orange: #F59E0B

Spacing System (4px grid):
- Use multiples of 4px: 4, 8, 12, 16, 20, 24, 32, 40, 60, 80
- Consistent spacing creates rhythm
- More space = more importance
- Mobile uses less spacing than desktop

Shadows:
- Subtle depth, not decoration
- Card shadow: 0 4px 20px rgba(0,0,0,0.5)
- Elevated shadow: 0 8px 32px rgba(0,0,0,0.6)
- No shadows on mobile (performance)

Border Radius:
- Small elements (badges, buttons): 8px
- Medium elements (cards, inputs): 12px
- Large elements (messages, containers): 16px
- Circular (voice button): 50%

Transitions:
- Duration: 200ms for most interactions
- Easing: ease or ease-out
- Properties: background-color, border-color, transform, opacity
- No transitions on layout properties (width, height) for performance

Japanese Minimalist Principles:
- Ma (negative space): Generous padding, let elements breathe
- Kanso (simplicity): Eliminate clutter, show only essential information
- Shizen (natural): Conversation flows naturally, no forced interactions
- Seijaku (calm): No aggressive colors, no urgency, peaceful experience
- Subtlety: Intelligence shown through use, not through explanation

===================================
PART 7: FUNCTIONAL REQUIREMENTS
===================================

Chat Functionality:
- Messages persist in database (never lost on refresh)
- Scroll to bottom when new message arrives
- "Typing..." indicator when Prof. OS is thinking
- Messages load in batches (last 50, then load more on scroll up)
- Input field clears after sending
- Send button disabled while message is sending
- Error handling: "Failed to send message. Try again." with retry button
- Offline detection: Show warning if internet connection lost

Session Management:
- User stays logged in for 30 days (unless they logout)
- Session stored in localStorage and cookie (redundant)
- Auto-refresh session on activity
- Logout clears all session data and redirects to landing page

Loading States:
- Skeleton loaders for content that's loading (not spinners)
- Progress indicators for multi-step processes (onboarding)
- Smooth transitions between loading and loaded states

Error Handling:
- Network errors: "Connection lost. Check your internet."
- Authentication errors: Redirect to login with message
- Server errors: "Something went wrong. Try again."
- Validation errors: Show inline, near the problematic field
- All errors: User-friendly language, no technical jargon

Performance:
- Images: Lazy load, optimize size
- Code splitting: Load chat page code only when needed
- Debounce search/filter inputs (300ms)
- Virtualize long lists if >100 items
- Minimize re-renders with React.memo or useMemo

Accessibility:
- Keyboard navigation works everywhere
- Focus states visible (blue outline)
- ARIA labels on icons and buttons
- Color contrast meets WCAG AA standards
- Screen reader friendly

===================================
PART 8: IMPLEMENTATION CHECKLIST
===================================

Authentication & Onboarding:
âœ… SMS verification for regular users
âœ… No SMS for lifetime members (admin-granted)
âœ… 4-step onboarding (username, belt, style, frequency)
âœ… Onboarding shown ONCE per user, EVER
âœ… Username uniqueness validation
âœ… Belt graphics displayed in onboarding
âœ… Database saves all profile data
âœ… onboarding_completed flag works correctly
âœ… Returning users skip directly to chat

Chat Page:
âœ… Header: "Prof. OS" + "Learns your game. Makes you better."
âœ… Welcome message: Mobile-first, Japanese minimalism, 3 capabilities + relationship + CTA
âœ… Input area: Fixed bottom, voice button inside input, send button below
âœ… Message bubbles: User right (blue), Prof. OS left (gray)
âœ… Timestamps: Formatted correctly (9:45 AM or Oct 22, 9:45 AM)
âœ… Date dividers: "Today", "Yesterday", "Oct 20"
âœ… Video cards: Thumbnail, title, instructor, watch button, feedback
âœ… Prof. OS personality: Journey-focused, training partner tone
âœ… AI context: Always includes user profile (belt, style, frequency)

Saved Videos Page:
âœ… Navigation: Route to /saved-videos (NOT /welcome)
âœ… Header: "Saved Videos"
âœ… Dual filters: Category + Instructor dropdowns
âœ… Filters work together (AND logic)
âœ… Real-time filtering (no apply button)
âœ… Video grid: 1 column mobile, 2 columns desktop
âœ… Video cards: Thumbnail, title, instructor, category badge, watch + remove buttons
âœ… Category badges: Colored by category type
âœ… Empty state: Icon + message when no videos saved
âœ… Save functionality: From chat to database to page

Mobile Optimization:
âœ… Designed for 375px first
âœ… Touch targets 48px minimum
âœ… Input font size 16px (prevents iOS zoom)
âœ… Safe area insets for iPhone
âœ… No horizontal scroll
âœ… Thumb-friendly layout
âœ… Keyboard doesn't cover input

Visual Quality:
âœ… Japanese minimalism throughout
âœ… Generous spacing (ma)
âœ… Typography hierarchy clear
âœ… Colors consistent with design system
âœ… Border radius consistent
âœ… Shadows subtle
âœ… Transitions smooth (200ms)
âœ… No pixelation, professional rendering

Database:
âœ… users table with all required fields
âœ… saved_videos table with all required fields
âœ… Proper indexes for performance
âœ… Foreign keys configured correctly

Excellence Standards:
âœ… Every element looks custom and premium
âœ… No generic out-of-the-box UI components
âœ… Intelligence shown through subtlety
âœ… Calm, confident, expensive aesthetic
âœ… Mobile-first responsive design
âœ… Fast, smooth, flawless performance

===================================
FINAL NOTES
===================================

This is not a minimum viable product. This is a PREMIUM product that practitioners will brag about using.

Excellence is our pillar. Every pixel matters. Every interaction should feel intentional. Every detail should be polished.

Users should feel:
- "This looks expensive"
- "This is way smarter than I expected"
- "This actually understands BJJ"
- "This is helping me improve"
- "I can't quit this"

Build with precision and care. Test thoroughly. Iterate until perfect.

Now implement everything above. No shortcuts. No compromises.
```