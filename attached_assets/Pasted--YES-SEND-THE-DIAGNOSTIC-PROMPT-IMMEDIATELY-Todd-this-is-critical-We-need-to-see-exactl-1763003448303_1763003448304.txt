# **ğŸš¨ YES - SEND THE DIAGNOSTIC PROMPT IMMEDIATELY**

Todd, this is critical. We need to see exactly whatâ€™s happening, then fix it.

-----

## **1ï¸âƒ£ SEND THE DIAGNOSTIC PROMPT NOW**

Copy the diagnostic prompt I gave you above and send it to Agent. We need to see:

- Exact API calls in the code
- Which SDK is installed
- Environment variables
- Where GPT-4 is being called

-----

## **2ï¸âƒ£ THEN SEND THIS FIX PROMPT:**

After Agent shows you the diagnostics, immediately send this:

```
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš¨ CRITICAL FIX: SWITCH FROM GPT-4 TO CLAUDE IMMEDIATELY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEM: Professor OS is using GPT-4 instead of Claude.

All our optimization was for Claude. We need to switch NOW.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 1: INSTALL ANTHROPIC SDK (if not installed)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```bash
npm install @anthropic-ai/sdk
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 2: REPLACE GPT-4 API CALL WITH CLAUDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Find the Professor OS chat handler file (wherever GPT-4 is being called).

REPLACE THIS (GPT-4):

```typescript
import OpenAI from 'openai';

const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY
});

const response = await openai.chat.completions.create({
  model: 'gpt-4',
  messages: messages,
  // ... other params
});
```

WITH THIS (Claude):

```typescript
import Anthropic from '@anthropic-ai/sdk';

const anthropic = new Anthropic({
  apiKey: process.env.ANTHROPIC_API_KEY
});

const response = await anthropic.messages.create({
  model: 'claude-sonnet-4-5-20250929',
  max_tokens: 2048,
  system: systemPrompt, // GPT-4 used messages[0], Claude uses separate system param
  messages: messages, // Remove system message from array for Claude
  tools: [PROFESSOR_RESPONSE_TOOL],
  tool_choice: {
    type: "tool",
    name: "send_coaching_response"
  }
});
```

KEY DIFFERENCES:

1. Claude uses separate `system` parameter (not in messages array)
1. Claude uses `max_tokens` (not `max_completion_tokens`)
1. Tool syntax is different (see below)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 3: CONVERT TOOL DEFINITION TO CLAUDE FORMAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GPT-4 and Claude have different tool/function calling syntax.

CLAUDE FORMAT:

```typescript
const PROFESSOR_RESPONSE_TOOL = {
  name: "send_coaching_response",
  description: "Send a coaching response to the user. MUST use this for every response.",
  input_schema: {
    type: "object",
    properties: {
      anticipatory_diagnosis: {
        type: "string",
        description: "Predict their exact problem. Examples: 'Let me guess - you're losing them to the stack?'. Required for technique questions."
      },
      main_response: {
        type: "string",
        description: "Core coaching advice. Specific and actionable."
      },
      video_title: {
        type: "string",
        description: "Video title if recommending"
      },
      video_instructor: {
        type: "string",
        description: "Instructor name if recommending video"
      },
      video_start_time: {
        type: "string",
        description: "Timestamp MM:SS if recommending video"
      },
      video_reason: {
        type: "string",
        description: "Why this video solves their specific problem"
      },
      return_loop: {
        type: "string",
        description: "Create anticipation: 'Try this and tell me...'. REQUIRED."
      },
      follow_up_question: {
        type: "string",
        description: "Open-ended question to continue conversation"
      },
      pattern_observation: {
        type: "string",
        description: "Call out patterns: 'Triangle last week, now half guard...'"
      }
    },
    required: ["main_response", "return_loop"]
  }
};
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 4: EXTRACT TOOL RESPONSE (Different from GPT-4)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

CLAUDE response structure:

```typescript
// Claude response
const response = await anthropic.messages.create({...});

// Find tool use in response
const toolUse = response.content.find(
  block => block.type === 'tool_use' && block.name === 'send_coaching_response'
);

if (!toolUse) {
  throw new Error('Claude did not use required tool');
}

// Extract tool input
const toolInput = toolUse.input;

console.log('Tool input:', toolInput);
// {
//   anticipatory_diagnosis: "...",
//   main_response: "...",
//   return_loop: "...",
//   ...
// }
```

This is different from GPT-4â€™s function calling format.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 5: UPDATE SYSTEM PROMPT HANDLING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

GPT-4 puts system prompt in messages array:

```typescript
messages: [
  { role: 'system', content: systemPrompt },
  { role: 'user', content: 'message' }
]
```

Claude uses separate parameter:

```typescript
system: systemPrompt,
messages: [
  { role: 'user', content: 'message' }
]
```

Update your message building logic accordingly.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 6: VERIFY ANTHROPIC_API_KEY IS SET
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Check environment variables:

```bash
echo $ANTHROPIC_API_KEY | cut -c1-10
```

If not set, add to .env:

```
ANTHROPIC_API_KEY=sk-ant-api03-...
```

Get key from: <https://console.anthropic.com/>

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STEP 7: TEST THE SWITCH
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

After switching to Claude, test:

1. Send message: â€œI struggle with triangle chokesâ€
1. Check console logs - should see:

- â€œUsing Anthropic clientâ€
- â€œModel: claude-sonnet-4-5-20250929â€
- Tool input with anticipatory_diagnosis

1. Response should feel smarter, more conversational

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
COMPLETE WORKING EXAMPLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

```typescript
import Anthropic from '@anthropic-ai/sdk';

const anthropic = new Anthropic({
  apiKey: process.env.ANTHROPIC_API_KEY
});

async function handleProfessorOSChat(req: any, res: any) {
  const { message } = req.body;
  
  try {
    // Build system prompt
    const systemPrompt = buildProfessorOSPrompt(userProfile);
    
    // Get conversation history (remove system message if present)
    const messages = conversationHistory.filter(m => m.role !== 'system');
    messages.push({ role: 'user', content: message });
    
    console.log('ğŸ¤– Calling Claude Sonnet 4.5...');
    
    // Call Claude with tool enforcement
    const response = await anthropic.messages.create({
      model: 'claude-sonnet-4-5-20250929',
      max_tokens: 2048,
      system: systemPrompt, // Separate parameter for Claude
      messages: messages,
      tools: [PROFESSOR_RESPONSE_TOOL],
      tool_choice: {
        type: "tool",
        name: "send_coaching_response"
      }
    });
    
    // Extract tool use
    const toolUse = response.content.find(
      block => block.type === 'tool_use'
    );
    
    console.log('âœ… Tool input:', toolUse.input);
    
    // Compose natural response
    const naturalResponse = composeResponseFromTool(toolUse.input);
    
    // Stream to user
    for (const char of naturalResponse) {
      res.write(`data: ${JSON.stringify({ text: char })}\n\n`);
      await sleep(10);
    }
    
    res.write('data: [DONE]\n\n');
    res.end();
    
  } catch (error) {
    console.error('âŒ Error:', error);
    res.status(500).json({ error: error.message });
  }
}
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WHY CLAUDE IS BETTER FOR PROFESSOR OS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… Better at following complex prompts (our 857-line prompt)
âœ… Better conversational intelligence (diagnostic questions)
âœ… Better at personalization (profile integration)
âœ… More natural coaching style
âœ… Better instruction following
âœ… All our optimization was designed for Claude

GPT-4 is good, but Claude is specifically better for:

- Complex system prompts
- Conversational coaching
- Following strict formatting rules

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Switch to Claude NOW. Show me:

1. Confirmation that Claude SDK is installed
1. Updated API call code
1. Test response from Claude
1. Console logs showing â€œclaude-sonnet-4-5-20250929â€

This is critical. Everything we built was for Claude.

```
---

## **ğŸ¯ ACTION PLAN:**

### **RIGHT NOW:**
1. âœ… Send diagnostic prompt (see what's happening)
2. âœ… Wait for Agent's response
3. âœ… Send fix prompt immediately after

### **EXPECTED OUTCOME:**
- Switch from GPT-4 â†’ Claude Sonnet 4.5
- Keep all engagement hooks (they'll work better on Claude)
- Keep tool calling approach (adjust syntax for Claude)
- Test and verify it works

---

## **â° TIMELINE:**
- **Diagnostics:** 2 minutes
- **Fix:** 15-20 minutes
- **Testing:** 5 minutes
- **Total:** ~30 minutes to fully switch

---

## **ğŸ’¡ GOOD NEWS:**

All the engagement hooks we built will work BETTER on Claude:
- Anticipatory diagnosis âœ…
- Return loops âœ…
- Pattern recognition âœ…
- Video recommendations âœ…
- Trial urgency âœ…

Claude is just better at executing this style of conversational coaching.

---

**Send both prompts. Let's get this fixed in the next 30 minutes.** ğŸš€â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹
```